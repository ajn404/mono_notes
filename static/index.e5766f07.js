let $r=[":",";",",","(",")","[","]","{","}","π","\xb1","+","-","*","/","%",'"',"'","`","@","=","^"],v={escape:t=>"\\"==t,space:t=>/[\r\n\t\s]/.test(t),digit:t=>/^[0-9]$/.test(t),sign:t=>/^[+-]$/.test(t),dot:t=>"."==t,quote:t=>/^["'`]$/.test(t),symbol:t=>$r.includes(t),hexNum:t=>/^[0-9a-f]$/i.test(t),hex:(t,r,n)=>"0"==t&&v.letter(r,"x")&&v.hexNum(n),expWithSign:(t,r,n)=>v.letter(t,"e")&&v.sign(r)&&v.digit(n),exp:(t,r)=>v.letter(t,"e")&&v.digit(r),dots:(t,r)=>v.dot(t)&&v.dot(r),letter:(t,r)=>String(t).toLowerCase()==String(r).toLowerCase(),comment:(t,r)=>"/"==t&&"*"==r,inlineComment:(t,r)=>"/"==t&&"/"===r,selfClosedTag:(t,r)=>"/"==t&&">"==r,closedTag:(t,r)=>"<"==t&&"/"==r};class U{constructor({type:t,value:r,pos:n,status:i}){this.type=t,this.value=r,this.pos=n,i&&(this.status=i)}isSymbol(...t){let r="Symbol"==this.type;return t.length?t.some(t=>t===this.value):r}isSpace(){return"Space"==this.type}isNumber(){return"Number"==this.type}isWord(){return"Word"==this.type}}function C(t){let r=-1,n=t.length,i=-1,s=0;return{curr:(n=0)=>t[r+n],next(n=1){let o=t[r+=n];return o===`
`?(s++,i=0):i+=n,o},end:()=>r>=n,get:()=>({prev:t[r-1],curr:t[r+0],next:t[r+1],next2:t[r+2],next3:t[r+3],pos:[i,s]})}}function Sr(t){for(;t.next();){let{curr:r,prev:n}=t.get();if(v.comment(r,n))break}}function kr(t){for(;t.next()&&t.curr()!==`
`;);}function mt(t){return[":",";",",","{","}","(",")","[","]"].includes(t)}function pt(t){let r="";for(;!t.end();){let{curr:n,next:i}=t.get();r+=n;let s=v.symbol(i)||v.space(i)||v.digit(i);if(r.length&&s&&!v.closedTag(n,i))break;t.next()}return r.trim()}function jr(t){let r="";for(;!t.end();){let{curr:n,next:i}=t.get();if(r+=n,!v.space(i))break;t.next()}return r}function dt(t){let r="",n=!1;for(;!t.end();){let{curr:i,next:s,next2:o,next3:l}=t.get();if(r+=i,n&&v.dot(s)||(v.dot(i)&&(n=!0),v.dots(s,o)))break;if(v.expWithSign(s,o,l))r+=t.next()+t.next();else if(v.exp(s,o))r+=t.next();else if(!v.digit(s)&&!v.dot(s))break;t.next()}return r}function Tr(t){let r="0x";for(t.next(2);!t.end();){let{curr:n,next:i}=t.get();if(r+=n,!v.hexNum(i))break;t.next()}return r}function ge(t){return t[t.length-1]}function z(t,r={}){let n=C(String(t).trim()),i=[],s=[];for(;n.next();){let{prev:t,curr:o,next:l,next2:a,pos:u}=n.get();if(v.comment(o,l))Sr(n);else if(r.ignoreInlineComment&&v.inlineComment(o,l))kr(n);else if(v.hex(o,l,a)){let t=Tr(n);i.push(new U({type:"Number",value:t,pos:u}))}else if(v.digit(o)||v.digit(l)&&v.dot(o)&&!v.dots(t,o)){let t=dt(n);i.push(new U({type:"Number",value:t,pos:u}))}else if(v.symbol(o)&&!v.selfClosedTag(o,l)){let t=ge(i),r=v.digit(l)||v.dot(l)&&v.digit(a);if("-"===o&&r&&(!t||!t.isNumber())){let t=dt(n);i.push(new U({type:"Number",value:t,pos:u}));continue}let c={type:"Symbol",value:o,pos:u};if(s.length&&v.escape(t.value)){i.pop();let t=pt(n);t.length&&i.push(new U({type:"Word",value:t,pos:u}))}else v.quote(o)&&(ge(s)==o?(s.pop(),c.status="close"):(s.push(o),c.status="open")),i.push(new U(c))}else if(v.space(o)){let t=jr(n),l=ge(i),{next:a}=n.get();if(!s.length&&l){let n=l.value,i=mt(n)&&")"!==n,s=mt(a)&&"("!==a;if(i||s)continue;t=r.preserveLineBreak?o:" "}i.length&&a&&a.trim()&&i.push(new U({type:"Space",value:t,pos:u}))}else{let t=pt(n);t.length&&i.push(new U({type:"Word",value:t,pos:u}))}}let o=ge(i);return o&&o.isSpace()&&(i.length=i.length-1),i}function Ar(t){return qt(C(z(t)))}function qt(t){let r=[];for(;t.next();){let{curr:n,next:i}=t.get();if("var"===n.value){if(i&&i.isSymbol("(")){t.next();let n=Er(t);Nr(n.name)&&r.push(n)}}else if(r.length&&!n.isSymbol(","))break}return r}function Er(t){let r={},n=[];for(;t.next();){let{curr:i,next:s}=t.get();if(i.isSymbol(")",";")&&!r.name){r.name=gt(n);break}i.isSymbol(",")?(void 0===r.name&&(r.name=gt(n),n=[]),r.name&&(r.fallback=qt(t))):n.push(i)}return r}function gt(t){return t.map(t=>t.value).join("")}function Nr(t){return!(void 0===t||t.length<=2||t.substr(2).startsWith("-")||!t.startsWith("--"))}function R(t,r,n){return Math.max(r,Math.min(n,t=Number(t)||0))}function Pr(t,r){return t?"function"==typeof r?r():r:""}function Rr(t,r,n){let i=0,s=t,o=t=>t>0&&t<1?.1:1,l=arguments.length;1==l&&([t,r]=[o(t),t]),l<3&&(n=o(t));let a=[];for(;(n>=0&&t<=r||n<0&&t>r)&&(a.push(t),t+=n,!(i++>=65535)););return a.length||a.push(s),a}function Dt(t,r){for(let[n,i]of Object.entries(r))t[n]=t[i];return t}function Oe(t){return/^[a-zA-Z]$/.test(t)}function b(t){return null==t}function ae(t){return b(t)||Number.isNaN(t)}function M(t){return b(t)||""===t}function te(t){let r=r=>(...n)=>t(r,...n);return r.lazy=!0,r}function Cr(t,r){let[n,i=1]=String(t).split(/[x-]/),[s,o]=[Math.ceil(n),Math.ceil(i)];ae(s)&&(s=1),ae(o)&&(o=1);let l=(n=R(s,0,65536))*(i=R(o,0,65536)),a=[],u=1;if(/x/.test(t))for(let t=1;t<=i;++t)for(let s=1;s<=n;++s)a.push(r(u,s,t,l,n,i,u)),u++;else if(/-/.test(t)){if(l=Math.abs(n-i)+1,n<=i)for(let t=n;t<=i;++t)a.push(r(t,t,1,l,l,1,u++));else for(let t=n;t>=i;--t)a.push(r(t,t,1,l,l,1,u++))}else for(let t=1;t<=n;++t)a.push(r(t,t,1,n,n,1,u++));return a}function ue(t,r,n){return"c-"+t+"-"+r+"-"+n}function S(t){let r=t;for(;r&&!b(r.value);)r=r.value;return b(r)?"":r}function Mr(t){return(b(t)?Date.now():String(t).replace(/\/.png$/g,""))+".png"}function Ft(t,r,n=0){let i=new Image;i.crossOrigin="anonymous",i.src=t,i.onload=function(){setTimeout(r,n)}}function Ve(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ye(t){let r=document.createElement("textarea");return r.innerHTML=t,r.value}function Lr(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ge(t,r=0){let n=3735928559^r,i=1103547991^r;for(let r=0,s;r<t.length;r++)n=Math.imul(n^(s=t.charCodeAt(r)),2654435761),i=Math.imul(i^s,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),4294967296*(2097151&(i=Math.imul(i^i>>>16,2246822507)^Math.imul(n^n>>>13,3266489909)))+(n>>>0)}function Ir(t){let r=t=>b(t)?"":t;return(n,...i)=>t(Or(n).reduce((t,n,s)=>t+n+r(i[s]),""))}function Xt(){let t=0;return (r="")=>`${r}-${++t}`}function I(t,r,n){return r+t*(n-r)}function re(t=""){return t+Math.random().toString(32).substr(2)}function Or(t){return b(t)?[]:Array.isArray(t)?t:[t]}function Ht(t){let[r,n=r]=(t+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map(t=>parseInt(t));return(!r||r<1)&&(r=1),(!n||n<1)&&(n=1),{x:r,y:n}}function A(t,r={symbol:",",noSpace:!1,verbose:!1}){let n=[],i=[],s=[],o=[],l="";if(M(t))return n;let a=C(z(t));function u(t){let n=r.symbol||[","];return Array.isArray(n)||(n=[n]),r.noSpace?t.isSymbol(...n):t.isSymbol(...n)||t.isSpace()}function c(t){let i=zr(t);r.verbose?(l.length||i.length)&&n.push({group:l,value:i}):n.push(i)}for(;a.next();){let{prev:t,curr:n,next:h}=a.get();n.isSymbol("(")&&s.push(n.value),n.isSymbol(")")&&s.pop(),"open"===n.status&&o.push(n.value),"close"===n.status&&o.pop();let p=!s.length&&!o.length;if(p){let i=r.noSpace&&n.isSpace()&&u(h),s=r.noSpace&&n.isSpace()&&u(t);if(i||s)continue}p&&u(n)?(c(i),l=n.value,i=[]):i.push(n)}return i.length&&c(i),n}function zr(t){return t.map(t=>t.value).join("")}function Br(t,r){let n=[],i,s=[],o=[];for(;t.next();){let{curr:r,next:l}=t.get();r.isSymbol("(")&&!s.length?o.push(r):r.isSymbol(")")&&!s.length&&o.pop(),r.isSymbol("'",'"')&&("open"===r.status?s.push(r):s.pop());let a=!s.length&&!o.length&&(!l||r.isSymbol(";")||l.isSymbol("}"));if(r.isSymbol("'",'"')&&l&&l.isSymbol("}")&&!s.length&&(a=!0),!o.length&&!s.length&&r.isSymbol("{")){let r=Vt(n);if(!r.length)continue;let s=r.pop(),o=Ze(...r,s);for(i=Ae(st(t,Ee(s,{type:"block",inline:!0,name:s,value:[]})),o);s=r.pop();)i=Ae(Ee(s,{type:"block",name:s,value:[i]}),o);break}if(n.push(r),a)break}return n.length&&!i?(r._valueTokens=n,r.value=fe(n)):i&&(r.value=i),r.origin&&(r.origin.value=r.value),r}function Wr(t){let r=[],n=[];for(;t.next();){let{curr:i}=t.get();if(i.isSymbol("{"))r.push(i.value);else if(i.isSymbol("}")){if(r.length)r.pop();else break}n.push(i.value)}return n.join("")}function st(t,r){let n=[],i=[],s=r&&r.type||"",o=[];for(;t.next();){let{prev:l,curr:a,next:u}=t.get();a.isSymbol("(")&&o.push(a.value),a.isSymbol(")")&&o.pop();let c=!u||a.isSymbol("}");if(ze(s)&&c){u||!n.length||a.isSymbol("}")||"string"!=typeof n[n.length-1].value||(n[n.length-1].value+=";"+a.value),r.value=n;break}if(a.isSymbol("{")){let s=Vt(i);if(!s.length)continue;Ze(r.name)&&(s=[fe(i)]);let o=s.pop(),l=Ze(...s,r.name,o);if("style"===o)n.push({type:"block",name:o,value:Wr(t)});else{let r=Ae(st(t,Ee(o,{type:"block",name:o,value:[]})),l);for(;o=s.pop();)r=Ae(Ee(o,{type:"block",name:o,value:[r]}),l);n.push(r)}i=[]}else if(a.isSymbol(":")&&!o.length&&!Ur(l,u)&&i.length){let o=qr(i,t=>t.isSymbol(",")),l={type:"statement",name:"unkown",value:""};o.length>1&&(l.origin={name:o});let a=Br(t,l),u=A(a.value),c=o.length>1&&u.length===o.length;o.forEach((t,r)=>{let i=Object.assign({},a,{name:t});/^\-\-/.test(t)&&(i.variable=!0),c&&(i.value=u[r]),/viewBox/i.test(t)&&(i.detail=Dr(i.value,i._valueTokens)),delete i._valueTokens,n.push(i)}),ze(s)&&(r.value=n),i=[]}else a.isSymbol(";")?n.length&&i.length&&(n[n.length-1].value+=";"+fe(i),i=[]):i.push(a)}return n.length&&ze(s)&&(r.value=n),s?r:n}function Ur(t,r){return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes((t&&t.value)+":"+(r&&r.value))}function fe(t){return t.filter((r,n)=>!(r.isSymbol(";","}")&&n===t.length-1)).map(t=>t.value).join("")}function Ae(t,r){let[n,...i]=(t.name||"").split(/#/),s=i[i.length-1];return n&&s&&!r&&(t.name=n,t.value.push({type:"statement",name:"id",value:s})),t}function qr(t,r){let n=[],i=[];return t.forEach(t=>{r(t)?(n.push(fe(i)),i=[]):i.push(t)}),i.length&&n.push(fe(i)),n}function Vt(t){let r=[],n=C(t),i;for(;n.next();){let{prev:t,curr:s,next:o}=n.get(),l=t&&o&&"x"===s.value&&t.isNumber()&&o.isNumber();!s.isWord()||i||l?r[r.length-1]=(r[r.length-1]+s.value).trim():r.push(s.value.trim()),s.isSymbol()?i=!0:s.isSpace()||(i=!1)}return r}function Dr(t,r){let n;let i={value:[]};if(!Array.isArray(r))return i;for(let t of r)t.isSpace()||t.isSymbol(",",";")||(i.value.length<4&&t.isNumber()?i.value.push(Number(t.value)):t.isNumber()&&n?(i[n]=Number(t.value),n=null):t.isWord()&&(n=t.value));return i}function Ee(t,r){let n=Object.assign({},r);if(/\*\s*[0-9]/.test(t)){let[r,i]=t.split("*");i&&(n.times=i.trim(),n.pureName=r.trim())}return n}function Ze(...t){return t.some(t=>"style"===t)}function ze(t){return"block"===t}function Fr(t){let r,n=[];for(let i of t.value)"svg"===i.name&&(r=i),i.variable&&n.push(i);return r&&Array.isArray(r.value)?(r.value.push(...n),r):t}function ie(t,r){return Fr(st(C(z(t)),r||{type:"block",name:"svg",value:[]}))}function Je(t,r){let n="";if("block"===t.type){let r=Array.isArray(t.value)&&t.value[0]&&t.value[0].inline;if(t.times?n+="@M"+t.times+"("+t.pureName+"{":n+=t.name+(r?" ":"{"),"style"===t.name)n+=t.value;else if(Array.isArray(t.value)&&t.value.length){let r="";for(let i of t.value)n+=Je(i,r),i.origin&&(r=i.origin.name.join(","))}t.times?n+="})":r||(n+="}")}else if("statement"===t.type){let i=t.origin&&r===t.origin.name.join(","),s=t.origin?t.origin.name.join(","):t.name,o=t.origin?t.origin.value:t.value;i||(n+=o&&o.type?s+":"+Je(o):s+":"+o+";")}return n}function Xr(t){return Je(t).trim()}function ye(t){return b(t)?[]:Array.isArray(t)?t:[t]}function _e(t,r=`
`){return(t||[]).join(r)}function w(t,r=1){return b(t)?"":t[t.length-r]}function yt(t){return t[0]}function Hr(t){return"u">typeof structuredClone?structuredClone(t):JSON.parse(JSON.stringify(t))}function Vr(t){return[].concat(t,t)}function Yt(t,r){return Array.prototype.flatMap?t.flatMap(r):t.reduce((t,n)=>t.concat(r(n)),[])}function Yr(t){return t.filter(t=>!b(t)&&String(t).trim().length)}let N={func:(t="")=>({type:"func",name:t,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(t="")=>({type:"text",value:t}),pseudo:(t="")=>({type:"pseudo",selector:t,styles:[]}),cond:(t="")=>({type:"cond",name:t,styles:[],arguments:[]}),rule:(t="")=>({type:"rule",property:t,value:[]}),keyframes:(t="")=>({type:"keyframes",name:t,steps:[]}),step:(t="")=>({type:"step",name:t,styles:[]})},E={white_space:t=>/[\s\n\t]/.test(t),line_break:t=>/\n/.test(t),number:t=>!isNaN(t),pair:t=>['"',"(",")","'"].includes(t),pair_of:(t,r)=>({'"':'"',"'":"'","(":")"})[t]==r},Ne={π:Math.PI,"∏":Math.PI};function _t(t){return/^@(canvas|shaders|doodle)/.test(t)}function Gt(t=""){let r=0,n=1,i=1;return{curr:(n=0)=>t[r+n],end:()=>t.length<=r,info:()=>({index:r,col:n,line:i}),index:t=>void 0===t?r:r=t,range:(r,n)=>t.substring(r,n),next(){let s=t[r++];return s==`
`?(i++,n=0):n++,s}}}function Gr(t,{col:r,line:n}){console.warn(`(at line ${n}, column ${r}) ${t}`)}function Zr(t){return t.trim().length?E.number(+t)?+t:t.trim():t}function lt(t){return function(r,n){let i=r.index(),s="";for(;!r.end();){let n=r.next();if(t(n))break;s+=n}return n&&r.index(i),s}}function Zt(t,r){return lt(t=>/[^\w@]/.test(t))(t,r)}function Jr(t){return lt(t=>/[\s\{]/.test(t))(t)}function Jt(t,r){return lt(t=>E.line_break(t)||"{"==t)(t,r)}function Kr(t,r){let n,i=N.step();for(;!t.end()&&"}"!=(n=t.curr());){if(E.white_space(n)){t.next();continue}if(i.name.length){if(i.styles.push(Ie(t,r)),"}"==t.curr())break}else i.name=er(t);t.next()}return i}function Qr(t,r){let n;let i=[];for(;!t.end()&&"}"!=(n=t.curr());){if(E.white_space(n)){t.next();continue}i.push(Kr(t,r)),t.next()}return i}function ei(t,r){let n=N.keyframes(),i;for(;!t.end()&&"}"!=(i=t.curr());){if(n.name.length){if("{"==i||"{"==t.curr(-1)){t.next(),n.steps=Qr(t,r);break}}else{if(Zt(t),n.name=Jr(t),!n.name.length){Gr("missing keyframes name",t.info());break}continue}t.next()}return n}function Le(t,r={}){for(t.next();!t.end();){let n=t.curr();if(r.inline){if(n==`
`)break}else if("*"==(n=t.curr())&&"/"==t.curr(1))break;t.next()}r.inline||(t.next(),t.next())}function ti(t){for(t.next();!t.end()&&">"!=t.curr();)t.next()}function ri(t){let r="",n;for(;!t.end()&&":"!=(n=t.curr());)E.white_space(n)||(r+=n),t.next();return r}function Ke(t,r,n){let i=[],s=[],o=[],l="",a,u="";for(;!t.end();){a=t.curr();let c=t.curr(-1),h=t.index();if(/[\('"`]/.test(a)&&"\\"!==c)o.length&&"("!==a&&a===w(o)?o.pop():o.push(a),l+=a;else if(("@"==a||"."===c&&r)&&!n)s.length||(l=l.trimLeft()),l.length&&(s.push(N.text(l)),l=""),s.push(Kt(t));else if(n&&/[)]/.test(a)||!n&&/[,)]/.test(a)){if(o.length)")"==a&&"("===w(o)&&o.pop(),l+=a;else{if(l.length&&(s.length?/\S/.test(l)&&s.push(N.text(l)):s.push(N.text(Zr(l))),l.startsWith("\xb1")&&!n)){let t=l.substr(1),r=Hr(s);w(r).value="-"+t,i.push(Be(r)),w(s).value=t}if(i.push(Be(s)),[s,l]=[[],""],")"==a)break}}else Ne[a]&&!/[0-9]/.test(t.curr(-1))&&(a=Ne[a]),l+=a;if(!r||")"!=t.curr(1)&&";"!=t.curr(1)&&/[0-9a-zA-Z_\-.]/.test(t.curr())||o.length)u+=t.range(h,t.index()+1),t.next();else{s.length&&i.push(Be(s));break}}return[ii(i),u]}function ii(t){let r=w(t[0]);return r&&"text"===r.type&&!String(r.value).trim().length&&(t[0]=t[0].slice(0,-1)),t}function Be(t){let r=t.map(t=>{if("text"==t.type&&"string"==typeof t.value){let r=String(t.value);r.includes("`")&&(t.value=r=r.replace(/`/g,'"')),t.value=r}return t}),n=yt(r)||{},i=w(r)||{};if("text"==n.type&&"text"==i.type){let t=yt(n.value),s=w(i.value);"string"==typeof n.value&&"string"==typeof i.value&&E.pair_of(t,s)&&(n.value=n.value.slice(1),i.value=i.value.slice(0,i.value.length-1),r.cluster=!0)}return r}function ni(t){let r="",n="";if(/\D$/.test(t)&&!/\d+[x-]\d+/.test(t)||Math[t.substr(1)])return{fname:t,extra:n};for(let i=t.length-1;i>=0;i--){let s=t[i],o=t[i-1],l=t[i+1];if(/[\d.]/.test(s)||("x"==s||"-"==s)&&/\d/.test(o)&&/\d/.test(l))n=s+n;else{r=t.substring(0,i+1);break}}return{fname:r,extra:n}}function si(t){let r=JSON.stringify(t);return r.includes("pureName")&&r.includes("times")}function li(t){return/^@svg$/i.test(t)}function Kt(t){let r=N.func(),n=t.curr(),i,s=!1;for("@"===n?t.next():n="@";!t.end();){i=t.curr();let o=t.curr(1),l="."==i&&("@"==o||/[a-zA-Z]/.test(o));if("("==i||l){s=!0,t.next();let[i,o]=Ke(t,l,_t(n));if(li(n)&&/\d\s*{/.test(o)){let t=ie(o);if(si(t)){let r=Xr(t);r+=")",i=Ke(Gt(r),l,_t(n))[0]}}r.arguments=i;break}if(/[0-9a-zA-Z_\-.]/.test(i)&&(n+=i),!s&&"("!==o&&!/[0-9a-zA-Z_\-.]/.test(o))break;t.next()}let{fname:o,extra:l}=ni(n);return r.name=o,l.length&&r.arguments.unshift([{type:"text",value:l}]),r.position=t.info().index,r}function Qt(t){let r=N.text(),n=0,i=!0,s,o=[];o[n]=[];let l=[],a=[];for(;!t.end();){if(s=t.curr(),i&&E.white_space(s)){t.next();continue}if(i=!1,s!=`
`||E.white_space(t.curr(-1))){if(","!=s||l.length){if(/[;}<]/.test(s)&&!a.length){r.value.length&&(o[n].push(r),r=N.text());break}"@"==s&&/\w/.test(t.curr(1))?(r.value.length&&(o[n].push(r),r=N.text()),o[n].push(Kt(t))):'"'===s||"'"===s?(s===w(a)?a.pop():a.length||a.push(s),r.value+=s):E.white_space(s)&&E.white_space(t.curr(-1))||("("==s&&l.push(s),")"==s&&l.pop(),Ne[s]&&!/[0-9]/.test(t.curr(-1))&&(s=Ne[s]),r.value+=s)}else r.value.length&&(o[n].push(r),r=N.text()),o[++n]=[],i=!0}else r.value+=" ";if((";"===t.curr()||"}"==t.curr())&&!a.length)break;t.next()}return r.value.length&&o[n].push(r),o}function er(t){let r="",n;for(;!t.end()&&"{"!=(n=t.curr());)r+=n,t.next();return r.trim()}function ai(t){let r={name:"",arguments:[]},n;for(;!t.end();){if("("==(n=t.curr()))t.next(),r.arguments=Ke(t)[0];else{if(/[){]/.test(n))break;r.name+=n}t.next()}let[i,...s]=r.name.trim().split(/\s+/);return r.name=i,r.addition=s,r}function tr(t,r){let n=N.pseudo(),i;for(;!t.end();){if("/"==(i=t.curr())&&"*"==t.curr(1))Le(t);else{if("}"==i)break;if(E.white_space(i)){t.next();continue}if(n.selector){let i=Ie(t,r);if("@use"==i.property?n.styles=n.styles.concat(i.value):i.property&&n.styles.push(i),"}"==t.curr())break}else n.selector=er(t)}t.next()}return n}function Ie(t,r){let n=N.rule(),i,s=t.index();for(;!t.end();){if("/"==(i=t.curr())&&"*"==t.curr(1))Le(t);else{if(";"==i)break;if(n.property.length){n.value=Qt(t);break}if(n.property=ri(t),"@use"==n.property){n.value=ui(t,r);break}}t.next()}let o=t.index();return n.raw=()=>t.range(s,o).trim(),n}function rr(t,r){let n=N.cond(),i;for(;!t.end();){if("/"==(i=t.curr())&&"*"==t.curr(1))Le(t);else{if("}"==i)break;if(n.name.length){if(":"==i){let r=tr(t);r.selector&&n.styles.push(r)}else if("@"!=i||Jt(t,!0).includes(":")){if(!E.white_space(i)){let i=Ie(t,r);if(i.property&&n.styles.push(i),"}"==t.curr())break}}else n.styles.push(rr(t))}else Object.assign(n,ai(t))}t.next()}return n}function vt(t,r){let n="";return t&&t.get_variable&&(n=t.get_variable(r)),n}function ir(t,r){t.forEach&&t.forEach(t=>{if("text"==t.type&&t.value){let n=Ar(t.value);t.value=n.reduce((t,n)=>{let i="",s="",o;(i=vt(r,n.name))||!n.fallback||n.fallback.every(t=>{if(s=vt(r,t.name))return i=s,!1});try{o=ne(i,r)}catch{}return o&&t.push.apply(t,o),t},[])}"func"==t.type&&t.arguments&&t.arguments.forEach(t=>{ir(t,r)})})}function ui(t,r){return t.next(),(Qt(t)||[]).reduce((t,n)=>{ir(n,r);let[i]=n;return i.value&&i.value.length&&t.push(...i.value),t},[])}function ne(t,r){let n=Gt(t),i=[];for(;!n.end();){let t=n.curr();if(E.white_space(t)){n.next();continue}if("/"==t&&"*"==n.curr(1))Le(n);else if(":"==t){let t=tr(n,r);t.selector&&i.push(t)}else if("@"==t&&"@keyframes"===Zt(n,!0)){let t=ei(n,r);i.push(t)}else if("@"!=t||Jt(n,!0).includes(":")){if("<"==t)ti(n);else if(!E.white_space(t)){let t=Ie(n,r);t.property&&i.push(t)}}else{let t=rr(n,r);t.name.length&&i.push(t)}n.next()}return i}function Qe(t,r=64){let[n,i,s]=[1,r,r*r],[o,l,a]=(t+"").replace(/\s+/g,"").replace(/[,，xX]+/g,"x").split("x").map(t=>parseInt(t)),u=1==o||1==l?s:i,c=1==o&&1==l?s:n,h={x:R(o||n,1,u),y:R(l||o||n,1,u),z:R(a||n,1,c)};return Object.assign({},h,{count:h.x*h.y*h.z,ratio:h.x/h.y})}function oi(t){let r=C(nr(z(t,{preserveLineBreak:!0,ignoreInlineComment:!0}))),n=[],i=[],s,o,l={textures:[]};for(;r.next();){let{curr:t,next:a}=r.get();if(t.isSymbol("{")){if(n.length)i.push(t);else{let r=We(i);fi(r)?(s=r,i=[]):i.push(t)}n.push("{")}else if(t.isSymbol("}")){if(n.pop(),!n.length&&s){let t=We(i);s&&t.length&&(s.startsWith("texture")?l.textures.push({name:s,value:t}):l[s]=t,i=[]),s=null}else i.push(t)}else M(o)||o==t.pos[1]||(i.push(bt()),o=null),(!s||!s.startsWith("texture"))&&t.isWord()&&t.value.startsWith("#")&&(i.push(bt()),o=a.pos[1]),i.push(t)}return M(l.fragment)&&(l.fragment=We(i),l.textures=l.textures||[]),l}function fi(t){return/^texture\w*$|^(fragment|vertex)$/.test(t)}function bt(){return new U({type:"LineBreak",value:`
`})}function nr(t){let r=t[0],n=t[t.length-1];for(;r&&r.isSymbol("(")&&n&&n.isSymbol(")");)r=(t=t.slice(1,t.length-1))[0],n=t[t.length-1];return t}function We(t){return nr(t).map(t=>t.value).join("")}let ci="http://www.w3.org/2000/svg",hi="http://www.w3.org/1999/xlink";function ve(t,r){return`url("data:image/svg+xml;utf8,${encodeURIComponent(t)+(r?`#${r}`:"")}")`}function xt(t){let r='xmlns="http://www.w3.org/2000/svg"',n='xmlns:xlink="http://www.w3.org/1999/xlink"';return t.includes("<svg")||(t=`<svg ${r} ${n}>${t}</svg>`),t.includes("xmlns")||(t=t.replace(/<svg([\s>])/,`<svg ${r} ${n}$1`)),t}let mi="http://www.w3.org/2000/svg",pi="http://www.w3.org/1999/xlink",di=Xt();class K{constructor(t,r=""){if(!t)throw Error("Tag name is required");this.name=t,this.body=[],this.attrs={},this.isTextNode()&&(this.body=r)}isTextNode(){return"text-node"===this.name}find(t){let r=t.attrs.id,n=t.name;if(Array.isArray(this.body)&&void 0!==r)return this.body.find(t=>t.attrs.id===r&&t.name===n)}append(t){this.isTextNode()||this.body.push(t)}merge(t){for(let[r,n]of Object.entries(t.attrs))this.attrs[r]=n;Array.isArray(t.body)&&this.body.push(...t.body)}attr(t,r){if(!this.isTextNode())return void 0===r?this.attrs[t]:this.attrs[t]=r}toString(){if(this.isTextNode())return wt(this.body);let t=[""],r=[];for(let[r,n]of Object.entries(this.attrs))n=wt(n),t.push(`${r}="${n}"`);for(let t of this.body)r.push(t.toString());return`<${this.name}${t.join(" ")}>${r.join("")}</${this.name}>`}}function gi(t,r){return`${t}:${r};`}function wt(t){let r=(t=String(t)).startsWith('"')&&t.endsWith('"'),n=t.startsWith("'")&&t.endsWith("'");return r||n?t.substring(1,t.length-1):t}function yi(t){let r=t.detail.value,n=t.detail.padding||t.detail.p||t.detail.expand;if(!r.length)return"";let[i,s,o,l]=r;return n&&([i,s,o,l]=[i-n,i-n,o+2*n,l+2*n]),`${i} ${s} ${o} ${l}`}function _i(t){return"path"===t||"line"===t||"circle"===t||"ellipse"===t||"rect"===t||"polygon"===t||"polyline"===t}function et(t,r,n,i){let s;if(r||(r=new K("root")),"block"===t.type){if("style"===t.name){let n=new K("style");n.append(t.value),r.append(n)}else{let n=new K(t.name);for(let r of(i||(i=n).attr("xmlns","http://www.w3.org/2000/svg"),t.value)){let o=et(r,n,t,i);o&&(s=o)}if(t.inline){let r=t.value.find(t=>"statement"===t.type&&"id"===t.name);r?s=r.value:(s=di(t.name),n.attr("id",s))}let o=i.find(n);o?o.merge(n):r.append(n)}}if("statement"===t.type&&!t.variable){if("content"===t.name){let n=new K("text-node",t.value);r.append(n)}else if(t.name.startsWith("style ")){let n=(t.name.split("style ")[1]||"").trim();if(n.length){let i=r.attr("style")||"";r.attr("style",i+gi(n,t.value))}}else{let s=t.value;if(s&&"block"===s.type){let r=et(t.value,i,t,i);s=`url(#${r})`,("xlink:href"===t.name||"href"===t.name)&&(s=`#${r}`)}if(/viewBox/i.test(t.name))(s=yi(t))&&r.attr(t.name,s);else if(("draw"===t.name||"animate"===t.name)&&_i(n&&n.name)){r.attr("stroke-dasharray",10),r.attr("pathLength",10);let t=new K("animate");t.attr("attributeName","stroke-dashoffset"),t.attr("from",10),t.attr("to",0),t.attr("dur",s),r.append(t)}else r.attr(t.name,s);t.name.includes("xlink:")&&i.attr("xmlns:xlink","http://www.w3.org/1999/xlink")}}return n?s:i.toString()}function be(t){return et(t)}function oe(t){let r=C(z(t)),n={},i=!1;for(;r.next();){let{prev:t,curr:s,next:o}=r.get(),l=i&&(s.isWord()||s.isSymbol())&&t&&t.isNumber()&&!o;if(s.isNumber())n.value=Number(s.value),i=!0;else if(l)n.unit=s.value;else break}return n}function $t(t){return(...r)=>{let n=[],i=[];for(let t of r){let{unit:r,value:s}=oe(t);void 0!==r&&n.push(r),void 0!==s&&i.push(s)}let s=t(...i),o=n.find(t=>void 0!==t);return void 0===o?s:Array.isArray(s)?s.map(t=>t+o):s+o}}function tt(t){return(...r)=>{let n=t(...r.map(t=>String(t).charCodeAt(0)));return Array.isArray(n)?n.map(t=>String.fromCharCode(t)):String.fromCharCode(n)}}let Ue=new Map,vi={π:Math.PI,gcd:(t,r)=>{for(;r;)[t,r]=[r,t%r];return t}},rt={"^":7,"*":6,"/":6,"\xf7":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function Pe(t,r,n=[]){let i=[];for(;t.length;){let{name:s,value:o,type:l}=t.shift();if("variable"===l){let t=r[o];ae(t)&&(t=Math[o]),ae(t)&&(t=St(o,r,n)),ae(t)&&/^\-\D/.test(o)&&(t=St("-1"+o.substr(1),r,n)),void 0===t&&(t=0),"number"!=typeof t&&(n.push(t),sr(n)?(t=0,n=[]):t=Pe(ce(t),r,n)),i.push(t)}else if("function"===l){let t=!1;/^\-/.test(s)&&(t=!0,s=s.substr(1));let l=o.map(t=>Pe(t,r,n)),a=s.split("."),u;for(;u=a.pop();){if(!u)continue;let t=r[u]||Math[u];l="function"==typeof t?Array.isArray(l)?t(...l):t(l):0}t&&(l*=-1),i.push(l)}else if(/\d+/.test(o))i.push(o);else{let t=i.pop(),r=i.pop();i.push(xi(o,Number(r),Number(t)))}}return Number(i[0])||0}function bi(t){if(Ue.has(t))return Ue.get(t);let r=String(t),n=[],i="";for(let t=0;t<r.length;++t){let s=r[t];if(rt[s]){let o=w(n);if("="==s&&o&&/^[!<>=]$/.test(o.value))o.value+=s;else if(/^[|&<>]$/.test(s)&&o&&o.value==s)o.value+=s;else if("-"==s&&"e"==r[t-1])i+=s;else if(!n.length&&!i.length&&/[+-]/.test(s))i+=s;else{let{type:t,value:r}=o||{};"operator"==t&&!i.length&&/[^()]/.test(s)&&/[^()]/.test(r)?i+=s:(i.length&&(n.push({type:"number",value:i}),i=""),n.push({type:"operator",value:s}))}}else/\S/.test(s)&&(","==s?(n.push({type:"number",value:i}),i="",n.push({type:"comma",value:s})):"!"==s?(n.push({type:"number",value:i}),n.push({type:"operator",value:s}),i=""):i+=s)}return i.length&&n.push({type:"number",value:i}),Ue.set(t,n),n}function ce(t){let r=bi(t),n=[],i=[];for(let t=0;t<r.length;++t){let{type:s,value:o}=r[t],l=r[t+1]||{};if("number"==s){if("("==l.value&&/[^\d.\-]/.test(o)){let n="",s=[],l=[];for(t+=1;void 0!==r[t++];){let i=r[t];if(void 0===i)break;let o=i.value;if(")"==o){if(!s.length)break;s.pop(),n+=o}else if("("==o&&s.push(o),","!=o||s.length)n+=o;else{let t=ce(n);t.length&&l.push(t),n=""}}n.length&&l.push(ce(n)),i.push({type:"function",name:o,value:l})}else/[^\d.\-]/.test(o)?i.push({type:"variable",value:o}):i.push({type:"number",value:o})}else if("operator"==s){if("("==o)n.push(o);else if(")"==o){for(;n.length&&"("!=w(n);)i.push({type:"operator",value:n.pop()});n.pop()}else{for(;n.length&&rt[w(n)]>=rt[o];){let t=n.pop();/[()]/.test(t)||i.push({type:"operator",value:t})}n.push(o)}}}for(;n.length;)i.push({type:"operator",value:n.pop()});return i}function xi(t,r,n){switch(t){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"%":return r%n;case"|":return r|n;case"&":return r&n;case"<":return r<n;case">":return r>n;case"^":return Math.pow(r,n);case"\xf7":case"/":return r/n;case"=":case"==":return r==n;case"≤":case"<=":return r<=n;case"≥":case">=":return r>=n;case"≠":case"!=":return r!=n;case"∧":case"&&":return r&&n;case"∨":case"||":return r||n;case"<<":return r<<n;case">>":return r>>n}}function St(t,r,n){let[i,s,o]=t.match(/([\d.\-]+)(.*)/)||[],l=r[o];return void 0===l?l:"number"==typeof l?Number(s)*l:(n.push(l),sr(n)?(n=[],0):s*Pe(ce(l),r,n))}function sr(t){if(t.length>50)return!0;let r=w(t);for(let n=2;n<=4;++n){let i=t[t.length-n];if(void 0===i||r!==i)return!1}return!0}function L(t,r){let n=ce(t);return Pe(n,Object.assign({},vi,r))}class wi{constructor(){this.cache={}}clear(){this.cache={}}set(t,r){if(b(t))return"";let n=this.getKey(t);return this.cache[n]=r}get(t){let r=this.getKey(t);return this.cache[r]}getKey(t){return Ge("string"==typeof t?t:JSON.stringify(t))}}let D=new wi;function at(t,r){return(...n)=>{let i=t+n.join("-");return D.get(i)||D.set(i,r(...n))}}function xe(t,r){return{type:t,value:r}}function $i(t){let r=String(t),n=[],i=[];if(!r.startsWith("[")||!r.endsWith("]"))return n;for(let t=1;t<r.length-1;++t){let s=r[t];if(!("-"==s&&"-"==r[t-1])){if("-"==s){i.push(s);continue}if("-"==w(i)){i.pop();let t=i.pop();n.push(t?xe("range",[t,s]):xe("char",s));continue}i.length&&n.push(xe("char",i.pop())),i.push(s)}}return i.length&&n.push(xe("char",i.pop())),n}let Si=at("build_range",t=>Yt($i(t),({type:t,value:r})=>{if("char"==t)return r;let[n,i]=r,s=!1;n>i&&([n,i]=[i,n],s=!0);let o=tt(Rr)(n,i);return s&&o.reverse(),o}));function Q(t){return(...r)=>t(...Yt(r,t=>String(t).startsWith("[")?Si(t):t))}class ki{constructor(t){this.prev=this.next=null,this.data=t}}class ji{constructor(t=20){this._limit=t,this._size=0}push(t){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let r=new ki(t);this.root?(r.prev=this.tail,this.tail.next=r,this.tail=r):this.root=this.tail=r,this._size++}last(t=1){let r=this.tail;for(;--t&&r.prev;)r=r.prev;return r.data}}class Ti{constructor(){this.p=Vr([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180])}grad(t,r,n,i){let s=15&t,o=s<8?r:n,l=s<4?n:12==s||14==s?r:i;return(1&s?-o:o)+(2&s?-l:l)}noise(t,r,n){let{p:i,grad:s}=this,[o,l,a]=[t,r,n].map(t=>255&Math.floor(t));[t,r,n]=[t,r,n].map(t=>t-Math.floor(t));let[u,c,h]=[t,r,n].map(t=>t*t*t*(t*(6*t-15)+10)),p=i[o]+l,f=i[p]+a,m=i[p+1]+a,d=i[o+1]+l,g=i[d]+a,y=i[d+1]+a;return I(h,I(c,I(u,s(i[f],t,r,n),s(i[g],t-1,r,n)),I(u,s(i[m],t,r-1,n),s(i[y],t-1,r-1,n))),I(c,I(u,s(i[f+1],t,r,n-1),s(i[g+1],t-1,r,n-1)),I(u,s(i[m+1],t,r-1,n-1),s(i[y+1],t-1,r-1,n-1))))}}function kt(t,r){let n={},i=!0;for(let s=0;s<t.length;++s){let o=t[s],l=r[s];if(/=/.test(o)){let[t,s]=A(o,{symbol:"=",noSpace:!0});void 0!==s?(r.includes(t)&&(n[t]=s),i=!1):n[l]=o}else i&&(n[l]=o)}return n}function se(t){let r=C(z(t)),n={},i=[],s,o=!1;for(;r.next();){let{prev:t,curr:l,next:a}=r.get();if(l.isSymbol(":")&&!s)s=qe(i),i=[];else if(l.isSymbol(";")&&s)n[s]=jt(s,qe(i),o),i=[],s=null,o=!1;else if(!l.isSymbol(";")){let r=t&&t.isSymbol("-"),n=a&&a.isSymbol("-"),u=l.isSymbol("-");s||i.length||!u||r||n?i.push(l):a&&a.isSymbol(":")?i.push(l):o=!0}}return i.length&&s&&(n[s]=jt(s,qe(i),o)),n}function jt(t,r,n){return["fill-rule","fill"].includes(t)?r:n?`-1 * (${r})`:r}function qe(t){return t.map(t=>t.value).join("")}let Ai=["auto","reverse"],Ei=["deg","rad","grad","turn"];function Ni(t){let r=C(z(t)),n=!1,i="",s={direction:"",angle:""};for(;r.next();){let{prev:t,curr:o,next:l}=r.get();if(o.isWord()&&Ai.includes(o.value))s.direction=o.value,n=!0;else if(o.isNumber())s.angle=Number(o.value),n=!0;else if(o.isWord()&&t&&t.isNumber()&&Ei.includes(o.value))i=o.value;else if(o.isSpace()&&""!==s.direction&&""!==s.angle)break}return n||(s.direction="auto"),Pi(s,i)}function Pi(t,r){let{angle:n}=t;return""===n&&(n=0),"rad"===r&&(n/=Math.PI/180),"grad"===r&&(n*=.9),"turn"===r&&(n*=360),Object.assign({},t,{angle:n})}let{cos:he,sin:me,abs:Ri,atan2:lr,PI:ut}=Math,k=Ir(t=>le(se(t),{min:3,max:3600})),Re={circle:()=>k`
    split: 180;
    scale: .99
  `,triangle:()=>k`
    rotate: 30;
    scale: 1.1;
    move: 0 .2
  `,pentagon:()=>k`
    split: 5;
    rotate: 54
  `,hexagon:()=>k`
    split: 6;
    rotate: 30;
    scale: .98
  `,octagon:()=>k`
    split: 8;
    rotat: 22.5;
    scale: .99
  `,star:()=>k`
    split: 10;
    r: cos(5t);
    rotate: -18;
    scale: .99
  `,infinity:()=>k`
    split: 180;
    scale: .99;
    x: cos(t)*.99 / (sin(t)^2 + 1);
    y: x * sin(t)
  `,heart:()=>k`
    split: 180;
    rotate: 180;
    a: cos(t)*13/18 - cos(2t)*5/18;
    b: cos(3t)/18 + cos(4t)/18;
    x: (.75 * sin(t)^3) * 1.2;
    y: (a - b + .2) * -1.1
  `,bean:()=>k`
    split: 180;
    r: sin(t)^3 + cos(t)^3;
    move: -.35 .35;
  `,bicorn:()=>k`
    split: 180;
    x: cos(t);
    y: sin(t)^2 / (2 + sin(t)) - .5
  `,drop:()=>k`
    split: 180;
    rotate: 90;
    scale: .95;
    x: sin(t);
    y: (1 + sin(t)) * cos(t) / 1.6
  `,fish:()=>k`
    split: 240;
    x: cos(t) - sin(t)^2 / sqrt(2) - .04;
    y: sin(2t)/2
  `,whale:()=>k`
    split: 240;
    rotate: 180;
    R: 3.4 * (sin(t)^2 - .5) * cos(t);
    x: cos(t) * R + .75;
    y: sin(t) * R * 1.2
  `,windmill:()=>k`
    split: 18;
    R: seq(.618, 1, 0);
    T: seq(t-.55, t, t);
    x: R * cos(T);
    y: R * sin(T)
  `,vase:()=>k`
    split: 240;
    scale: .3;
    x: sin(4t) + sin(t) * 1.4;
    y: cos(t) + cos(t) * 4.8 + .3
  `,clover:(t=3)=>(4==(t=R(t,3,5))&&(t=2),k`
      split: 240;
      r: cos(${t}t);
      scale: .98
    `),hypocycloid:(t=3)=>{let r=[0,0,0,.34,.25,.19][t=R(t,3,5)];return k`
      split: 240;
      scale: ${r};
      k: ${t};
      x: (k-1)*cos(t) + cos((k-1)*t);
      y: (k-1)*sin(t) - sin((k-1)*t)
    `},bud:(t=3)=>(t=R(t,3,10),k`
      split: 240;
      scale: .8;
      r: 1 + .2 * cos(${t}t)
    `)};class Tt{constructor(t,r,n){this.x=t,this.y=r,this.extra=n}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}}function Ci(t,r){"function"==typeof arguments[0]&&(r=t,t={}),r||(r=t=>[he(t),me(t)]);let n=t.split||180,i=t.turn||1,s=t.frame,o=t.fill||t["fill-rule"],l=Ni(t.direction||t.dir||""),a=t.unit,u=2*ut*i/n,c=[],h,p,f=void 0===t.scale?1:t.scale,m=([t,r,n=0,i=0])=>{if("evenodd"==t||"nonzero"==t)return c.push(new Tt(t,"",""));let[s,o]=At(t,-r,f),[u,h]=At(n,-i,f),p=Mi(s,o,u,h,l);void 0!==a&&"%"!==a?"none"!==a&&(s+=a,o+=a):(s=(s+1)*50+"%",o=(o+1)*50+"%"),c.push(new Tt(s,o,p))};("nonzero"==o||"evenodd"==o)&&m([o,"",""]);for(let t=0;t<n;++t){let n=r(u*t,t);t||(h=n),m(n)}if(void 0!==s){m(h);let t=s/100;i>1&&(t*=2),0==t&&(t=.002);for(let i=0;i<n;++i){let[n,s,o=0,l=0]=r(-u*i,i),a=lr(s+l,n-o),c=[n-t*he(a),s-t*me(a)];i||(p=c),m(c)}m(p),m(h)}return c}function Mi(t,r,n,i,s){let o=180*lr(r+i,t-n)/ut;return"reverse"===s.direction&&(o-=180),s.direction||(o=90),s.angle&&(o+=s.angle),o}function Li(t,r,n){let i=-ut/180*n;return[t*he(i)-r*me(i),r*he(i)+t*me(i)]}function Ii(t,r,n){let[i,s=i]=A(n).map(Number);return[t+(i||0),r-(s||0),i,s]}function At(t,r,n){let[i,s=i]=A(n).map(Number);return[t*i,r*s]}function le(t,{min:r,max:n}){let i=R(parseInt(t.vertices||t.points||t.split)||0,r,n),s=M(t.x)?"cos(t)":t.x,o=M(t.y)?"sin(t)":t.y,l=M(t.r)?"":t.r,a=M(t.t)?"":t.t,{unit:u,value:c}=oe(l);return u&&!t[u]&&"t"!==u&&(M(t.unit)&&(t.unit=u),l=t.r=c),t.degree&&(t.rotate=t.degree),t.origin&&(t.move=t.origin),Ci(Object.assign({},t,{split:i}),(r,n)=>{let u=Object.assign({},t,{t:a||r,θ:a||r,i:n+1,seq:(...t)=>t.length?t[n%t.length]:"",range(t,r=0){t=Number(t)||0,r=Number(r)||0,t>r&&([t,r]=[r,t]);let s=Ri(r-t)/(i-1);return t+s*n}}),c=L(s,u),h=L(o,u),p=0,f=0;if(l){let t=L(l,u);0==t&&(t=1e-5),a&&(r=L(a,u)),c=t*he(r),h=t*me(r)}return t.rotate&&([c,h]=Li(c,h,Number(t.rotate)||0)),t.move&&([c,h,p,f]=Ii(c,h,t.move)),[c,h,p,f]})}let Oi="MmLlHhVvCcSsQqTtAaZz",zi="mlhvcsqtaz";function we(t){let r=C(z(t)),n={},i={commands:[],valid:!0};for(;r.next();){let{curr:t}=r.get();if(!(t.isSpace()||t.isSymbol(","))){if(t.isWord())n.name&&(i.commands.push(n),n={}),n.name=t.value,n.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(t.value)?"mlhvcsqtaz".includes(t.value)?n.type="relative":n.type="absolute":(n.type="unknown",i.valid=!1);else if(n.value){let r=t.value;t.isNumber()&&(r=Number(t.value)),n.value.push(r)}else n.name||(i.valid=!1)}}return n.name&&i.commands.push(n),i}let T={name:"cssd-uniform-time","animation-name":"cssd-uniform-time-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};T.animation=`
  ${T["animation-duration"]}ms
  ${T["animation-timing-function"]}
  ${T["animation-delay"]}
  ${T["animation-iteration-count"]}
  ${T["animation-name"]}
`;let ar={name:"cssd-uniform-mousex"},ur={name:"cssd-uniform-mousey"},or={name:"cssd-uniform-width"},fr={name:"cssd-uniform-height"},V=Object.freeze(Object.defineProperty({__proto__:null,uniform_height:fr,uniform_mousex:ar,uniform_mousey:ur,uniform_time:T,uniform_width:or},Symbol.toStringTag,{value:"Module"}));function De(t){return te((r,n,...i)=>{if(!i||!n)return"";let s=S(n()),o=s;/\D/.test(s)&&!/\d+[x-]\d+/.test(s)&&0===(o=L(s))&&(o=s);let l=Math.random();return Cr(o,(...t)=>i.map(r=>S(r(...t,l))).join(",")).join(t)})}function F(t,r,n){return t[r]||(t[r]=new ji(1024)),t[r].push(n),n}function Et(t){return -1*t}function Bi(t,r,n,i=1){let s=Math.sqrt(.5)*i,[o,l]=[-s,s];return I((t-o)/(l-o),r*i,n*i)}function Nt(t,r,n){switch(t){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n;case"%":return r%n;default:return 0}}function P(t){return r=>{if(M(r)||M(t))return t;if(/^[+*-\/%][\-.\d\s]/.test(r)){let n=r[0],{unit:i="",value:s}=oe(r.substr(1).trim()||0);return Nt(n,t,s)+i}if(/[+*-\/%]$/.test(r)){let n=r.substr(-1),{unit:i="",value:s}=oe(r.substr(0,r.length-1).trim()||0);return Nt(n,s,t)+i}{let{unit:n="",value:i}=oe(r||0);return t+i+n}}}let Ce=Dt({i:({count:t})=>P(t),y:({y:t})=>P(t),x:({x:t})=>P(t),z:({z:t})=>P(t),I:({grid:t})=>P(t.count),Y:({grid:t})=>P(t.y),X:({grid:t})=>P(t.x),Z:({grid:t})=>P(t.z),id:({x:t,y:r,z:n})=>i=>ue(t,r,n),dx:({x:t,grid:r})=>n=>t-.5-(n=Number(n)||0)-r.x/2,dy:({y:t,grid:r})=>n=>t-.5-(n=Number(n)||0)-r.y/2,n({extra:t}){let r=w(t);return r?P(r[0]):"@n"},nx({extra:t}){let r=w(t);return r?P(r[1]):"@nx"},ny({extra:t}){let r=w(t);return r?P(r[2]):"@ny"},N({extra:t}){let r=w(t);return r?P(r[3]):"@N"},m:De(","),M:De(" "),µ:De(""),p:({context:t,pick:r})=>Q((...n)=>{n.length||(n=t.last_pick_args||[]);let i=r(n);return t.last_pick_args=n,F(t,"last_pick",i)}),P({context:t,pick:r,position:n}){let i="P-counter"+n;return Q((...n)=>{let s=!0;n.length||(n=t.last_pick_args||[],s=!1);let o=t.last_pick,l=o?o.last(1):"";if(s&&(t[i]||(t[i]={}),l=t[i].last_pick),n.length>1){let t=n.findIndex(t=>t===l);-1!==t&&n.splice(t,1)}let a=r(n);return t.last_pick_args=n,s&&(t[i].last_pick=a),F(t,"last_pick",a)})},pl({context:t,extra:r,position:n}){let i=w(r),s="pl-counter"+n+(i?w(i):"");return Q((...r)=>{t[s]||(t[s]=0),t[s]+=1;let n=r.length,o=i&&i[6];return b(o)&&(o=t[s]),F(t,"last_pick",r[(o-1)%n])})},pr({context:t,extra:r,position:n}){let i=w(r),s="pr-counter"+n+(i?w(i):"");return Q((...r)=>{t[s]||(t[s]=0),t[s]+=1;let n=r.length,o=i&&i[6];b(o)&&(o=t[s]);let l=(o-1)%n;return F(t,"last_pick",r[n-l-1])})},pd({context:t,extra:r,position:n,shuffle:i}){let s=w(r),o=s?w(s):"",l="pd-counter"+n+o,a="pd-values"+n+o;return Q((...r)=>{t[l]||(t[l]=0),t[l]+=1,t[a]||(t[a]=i(r||[]));let n=r.length,o=s&&s[6];b(o)&&(o=t[l]);let u=(o-1)%n,c=t[a][u];return F(t,"last_pick",c)})},lp:({context:t})=>(r=1)=>{let n=t.last_pick;return n?n.last(r):""},r:({context:t,rand:r})=>(...n)=>F(t,"last_rand",(n.every(Oe)?tt:$t)(r)(...n)),rn({x:t,y:r,context:n,position:i,grid:s,extra:o,random:l}){let a="noise-2d"+i,u=a+"offset-x",c=a+"offset-y",[h,p,f,m,d,g]=w(o)||[],y=h&&m;return(...i)=>{let{from:o=0,to:h=o,frequency:m=1,scale:x=1,octave:_=1}=kt(i,["from","to","frequency","scale","octave"]);m=R(m,0,1/0),x=R(x,0,1/0),_=R(_,1,100),1==i.length&&([o,h]=[0,o]),n[a]||(n[a]=new Ti),n[u]||(n[u]=l()),n[c]||(n[c]=l());let $=Oe(o)&&Oe(h)?tt:$t,j=n[a],B=n[u],Y=n[c],Z=(y?(p-1)/d:(t-1)/s.x)+B,G=(y?(f-1)/g:(r-1)/s.y)+Y;(d<=1||s.x<=1)&&(Z=0),(g<=1||s.y<=1)&&(G=0),0==Z&&0==G&&(Z=B,G=Y);let J=j.noise(Z*m,G*m,0)*x;for(let t=1;t<_;++t){let r=2*t;J+=j.noise(Z*m*r,G*m*r,0)*(x/r)}return F(n,"last_rand",$((t,r)=>Bi(J,t,r,x))(o,h))}},lr:({context:t})=>(r=1)=>{let n=t.last_rand;return n?n.last(r):""},stripe:()=>(...t)=>{let r=t.map(S),n=r.length,i=0,s=[],o;if(!n)return"";r.forEach(t=>{let[r,n]=A(t);void 0!==n?s.push(n):i+=1});let l=s.length?`(100% - ${s.join(" - ")}) / ${i}`:`100% / ${n}`;return r.map((t,r)=>{if(s.length){let[r,n]=A(t);return o=(o?o+" + ":"")+(void 0!==n?n:l),`${r} 0 calc(${o})`}return`${t} 0 ${100/n*(r+1)}%`}).join(",")},calc:()=>t=>L(S(t)),hex:()=>t=>parseInt(S(t)).toString(16),svg:te((t,...r)=>{let n=r.map(t=>S(t())).join(",");return n.startsWith("<")||(n=be(ie(n))),ve(xt(n))}),"svg-filter":te((t,...r)=>{let n=r.map(t=>S(t())),i=n.join(","),s=re("filter-");if(n.every(t=>/^[\-\d.]/.test(t)||/^(\w+)/.test(t)&&!/[{}<>]/.test(t))){let{frequency:r,scale:s,octave:o,seed:l=t.seed,blur:a,erode:u,dilate:c}=kt(n,["frequency","scale","octave","seed","blur","erode","dilate"]);if(i=`
        x: -20%;
        y: -20%;
        width: 140%;
        height: 140%;
      `,b(c)||(i+=`
          feMorphology {
            operator: dilate;
            radius: ${c};
          }
        `),b(u)||(i+=`
          feMorphology {
            operator: erode;
            radius: ${u};
          }
        `),b(a)||(i+=`
          feGaussianBlur {
            stdDeviation: ${a};
          }
        `),!b(r)){let[t,n=t]=A(r);o=o?`numOctaves: ${o};`:"",i+=`
          feTurbulence {
            type: fractalNoise;
            baseFrequency: ${t} ${n};
            seed: ${l};
            ${o}
          }
        `,s&&(i+=`
            feDisplacementMap {
              in: SourceGraphic;
              scale: ${s};
            }
          `)}}return i.startsWith("<")||(i=be(ie(i,{type:"block",name:"filter"}))),ve(xt(i).replace(/<filter([\s>])/,`<filter id="${s}"$1`),s)}),"svg-pattern":te((t,...r)=>{let n=r.map(t=>S(t())).join(",");return ve(be(ie(`
      viewBox: 0 0 1 1;
      preserveAspectRatio: xMidYMid slice;
      rect {
        width, height: 100%;
        fill: defs pattern { ${n} }
      }
    `)))}),"svg-polygon":te((t,...r)=>{let n=se(r.map(t=>S(t())).join(","));delete n.frame,n.unit="none",n["stroke-width"]??=.01,n.stroke??="currentColor",n.fill??="none";let i=`points: ${le(n,{min:3,max:65536})};`,s="";for(let t of Object.keys(n))/^(stroke|fill|clip|marker|mask|animate|draw)/.test(t)&&(s+=`${t}: ${n[t]};`);return ve(be(ie(`
      viewBox: -1 -1 2 2 p ${Number(n["stroke-width"])/2};
      polygon {
        ${s} ${i}
      }
    `)))}),var:()=>t=>`var(${S(t)})`,ut:()=>t=>`var(--${T.name})`,uw:()=>t=>`var(--${or.name})`,uh:()=>t=>`var(--${fr.name})`,ux:()=>t=>`var(--${ar.name})`,uy:()=>t=>`var(--${ur.name})`,plot({count:t,context:r,extra:n,position:i,grid:s}){let o="offset-points"+i,l=w(n);return n=>{let[i=t,a,u,c=s.count]=l||[];if(!r[o]){let t=se(n);delete t.fill,delete t["fill-rule"],delete t.frame,t.points=c,r[o]=le(t,{min:1,max:65536})}return r[o][i-1]}},Plot({count:t,context:r,extra:n,position:i,grid:s}){let o="Offset-points"+i,l=w(n);return n=>{let[i=t,a,u,c=s.count]=l||[];if(!r[o]){let t=se(n);delete t.fill,delete t["fill-rule"],delete t.frame,t.points=c,t.unit=t.unit||"none",r[o]=le(t,{min:1,max:65536})}return r[o][i-1]}},shape:()=>at("shape-function",(t="",...r)=>{t=String(t).trim();let n=[];if(t.length){if("function"==typeof Re[t])n=Re[t](r);else{let i=t,s=r.join(",");s.length&&(i=t+","+s),n=le(se(i),{min:3,max:3600})}}return`polygon(${n.join(",")})`}),doodle:()=>t=>t,shaders:()=>t=>t,canvas:()=>t=>t,pattern:()=>t=>t,invert:()=>t=>{let r=we(t);return r.valid?r.commands.map(({name:t,value:r})=>{switch(t){case"v":return"h"+r.join(" ");case"V":return"H"+r.join(" ");case"h":return"v"+r.join(" ");case"H":return"V"+r.join(" ");default:return t+r.join(" ")}}).join(" "):t},flipH:()=>t=>{let r=we(t);return r.valid?r.commands.map(({name:t,value:r})=>{switch(t){case"h":case"H":return t+r.map(Et).join(" ");default:return t+r.join(" ")}}).join(" "):t},flipV:()=>t=>{let r=we(t);return r.valid?r.commands.map(({name:t,value:r})=>{switch(t){case"v":case"V":return t+r.map(Et).join(" ");default:return t+r.join(" ")}}).join(" "):t},flip(...t){let r=Ce.flipH(...t),n=Ce.flipV(...t);return t=>n(r(t))},reverse:()=>(...t)=>{let r=t.map(S),n=we(r.join(","));if(n.valid){let t=[];for(let r=n.commands.length-1;r>=0;--r){let{name:i,value:s}=n.commands[r];t.push(i+s.join(" "))}return t.join(" ")}return r.reverse()},cycle:()=>(...t)=>{t=t.map(t=>"("+t+")");let r=[],n;1==t.length?(n=" ",r=A(t[0],{symbol:n})):(n=",",r=A(t.map(S).join(n),{symbol:n}));let i=(r=r.map(t=>t.replace(/^\(|\)$/g,""))).length-1,s=[r.join(n)];for(let t=0;t<i;++t){let t=r.shift();r.push(t),s.push(r.join(n))}return s},mirror:()=>(...t)=>{for(let r=t.length-1;r>=0;--r)t.push(t[r]);return t},Mirror:()=>(...t)=>{for(let r=t.length-2;r>=0;--r)t.push(t[r]);return t},unicode:()=>(...t)=>t.map(t=>String.fromCharCode(t)),once({context:t,extra:r,position:n}){let i="once-counter"+n;return(...r)=>(b(t[i])&&(t[i]=r),t[i])},raw:({rules:t})=>(r="")=>{try{let n=r.substring(r.indexOf(",")+1,r.lastIndexOf('")'));if(r.startsWith("${doodle")&&r.endsWith("}")){let n=r.substring(2,r.length-1),i=t.doodles;if(i&&i[n])return`<css-doodle>${i[n].doodle}</css-doodle>`}if(r.startsWith('url("data:image/svg+xml;utf8'))return decodeURIComponent(n);if(r.startsWith('url("data:image/svg+xml;base64'))return atob(n);if(r.startsWith('url("data:image/png;base64'))return`<img src="${r}" alt="" />`}catch{}return r}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut",filter:"svg-filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"\xb5",repeat:"\xb5",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z",Svg:"svg","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",paint:"canvas"}),cr={"4a0":[1682,2378],"2a0":[1189,1682],a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],a7:[74,105],a8:[52,74],a9:[37,52],a10:[26,37],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],b7:[88,125],b8:[62,88],b9:[44,62],b10:[31,44],b11:[22,32],b12:[16,22],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],c6:[114,162],c7:[81,114],c8:[57,81],c9:[40,57],c10:[28,40],c11:[22,32],c12:[16,22],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},Wi={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"},Ui="mm";function qi(t,r){let[n,i]=cr[t=String(t).toLowerCase()]||[];return"p"==Wi[r]&&([i,n]=[n,i]),[i,n].map(t=>t+"mm")}function Di(t){return!!cr[t]}let $e=[];function hr(t){if(!$e.length){let t=new Set;if("u">typeof document)for(let r in document.head.style)r.startsWith("-")||t.add(r.replace(/[A-Z]/g,"-$&").toLowerCase());t.has("grid-gap")||t.add("grid-gap"),$e=Array.from(t)}return t instanceof RegExp?$e.filter(r=>t.test(r)):$e}function mr(t){let r=RegExp(`\\-?${t}\\-?`);return hr(r).map(t=>t.replace(r,"")).reduce((t,r)=>(t[r]=r,t),{})}let Fi=mr("webkit"),Xi=mr("moz");function pr(t,r){return Fi[t]?`-webkit-${r} ${r}`:Xi[t]?`-moz-${r} ${r}`:r}let Hi={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},Vi={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"},Se=Dt({size(t,{is_special_selector:r,grid:n}){let[i,s=i,o]=A(t);Di(i)&&([i,s]=qi(i,s));let l=`
      width: ${i};
      height: ${s};
    `;return("auto"===i||"auto"===s)&&(o&&(/^\(.+\)$/.test(o)?o=o.substring(1,o.length-1):/^calc/.test(o)||(o=`calc(${o})`),r||(l+=`aspect-ratio: ${o};`)),r&&(l+=`aspect-ratio: ${o||n.ratio};`)),r||(l+=`
        --internal-cell-width: ${i};
        --internal-cell-height: ${s};
      `),l},place(t,{extra:r}){let[n,i="50%"]=A(t);n=Hi[n]||n,i=Vi[i]||i;let s="var(--internal-cell-width, 25%)",o="var(--internal-cell-height, 25%)";return`
      position: absolute;
      left: ${n};
      top: ${i};
      width: ${s};
      height: ${o};
      margin-left: calc(${s} / -2);
      margin-top: calc(${o} / -2);
      grid-area: unset;
      --plot-angle: ${r||0};
      rotate: ${r||0}deg;
    `},grid(t,r){let n={clip:!0};for(let{group:i,value:s}of(/no\-*clip/i.test(t)&&(n.clip=!1,t=t.replace(/no\-*clip/i,"")),A(t,{symbol:["/","+","*","|","-","~"],noSpace:!0,verbose:!0})))"+"===i&&(n.scale=s),"*"===i&&(n.rotate=s),"~"===i&&(n.translate=s),"/"===i&&(void 0===n.size?n.size=this.size(s,r):n.fill=s),"|"!==i&&"-"!=i&&""!=i||n.grid||(n.grid=Qe(s,r.max_grid),"|"===i&&(n.flexColumn=!0),"-"!==i||(n.flexRow=!0));return n},gap:t=>t,seed:t=>t,shape:at("shape-property",t=>{let[r,...n]=A(t);if("function"!=typeof Re[r])return"";let i="clip-path",s=Re[r](...n),o=`${i}: polygon(${s.join(",")});`;return pr(i,o)+"overflow: hidden;"}),use(t){if(t.length>2)return t},content:t=>t},{"place-cell":"place",offset:"place",position:"place"}),W={even:t=>!(t%2),odd:t=>!!(t%2)};function Fe(t,r,n){for(let i=0;i<=n;++i)if(L(t,{n:i})==r)return!0}let Yi={at:({x:t,y:r})=>(n,i)=>t==n&&r==i,nth:({count:t,grid:r})=>(...n)=>n.some(n=>W[n]?W[n](t):Fe(n,t,r.count)),row:({y:t,grid:r})=>(...n)=>n.some(n=>W[n]?W[n](t):Fe(n,t,r.y)),col:({x:t,grid:r})=>(...n)=>n.some(n=>W[n]?W[n](t):Fe(n,t,r.x)),even:({count:t,grid:r,x:n,y:i})=>t=>W.odd(n+i),odd:({count:t,grid:r,x:n,y:i})=>t=>W.even(n+i),random:({random:t,count:r,x:n,y:i,grid:s})=>(o=.5)=>/\D/.test(o)?t()<L("("+o+")",{x:n,X:s.x,y:i,Y:s.y,i:r,I:s.count,random:t}):t()<o,match:({count:t,grid:r,x:n,y:i,random:s})=>o=>!!L("("+o+")",{x:n,X:r.x,y:i,Y:r.y,i:t,I:r.count,random:s})};var Pt,ee=globalThis,pe=Math,Me=[],O=256,dr=6,Gi=52,Zi="random",Ji=pe.pow(O,dr),gr=pe.pow(2,Gi),Ki=2*gr,X=O-1;function ke(t,r,n){var i=[],s=it(yr((r=!0==r?{entropy:!0}:r||{}).entropy?[t,de(Me)]:t??en(),3),i),o=new Qi(i),l=function(){for(var t=o.g(dr),r=Ji,n=0;t<gr;)t=(t+n)*O,r*=O,n=o.g(1);for(;t>=Ki;)t/=2,r/=2,n>>>=1;return(t+n)/r};return l.int32=function(){return 0|o.g(4)},l.quick=function(){return o.g(4)/4294967296},l.double=l,it(de(o.S),Me),(r.pass||n||function(t,r,n,i){return i&&(i.S&&Rt(i,o),t.state=function(){return Rt(o,{})}),n?(pe[Zi]=t,r):t})(l,s,"global"in r?r.global:this==pe,r.state)}function Qi(t){var r,n=t.length,i=this,s=0,o=i.i=i.j=0,l=i.S=[];for(n||(t=[n++]);s<O;)l[s]=s++;for(s=0;s<O;s++)l[s]=l[o=X&o+t[s%n]+(r=l[s])],l[o]=r;(i.g=function(t){for(var r,n=0,s=i.i,o=i.j,l=i.S;t--;)r=l[s=X&s+1],n=n*O+l[X&(l[s]=l[o=X&o+r])+(l[o]=r)];return i.i=s,i.j=o,n})(O)}function Rt(t,r){return r.i=t.i,r.j=t.j,r.S=t.S.slice(),r}function yr(t,r){var n,i=[],s=typeof t;if(r&&"object"==s)for(n in t)try{i.push(yr(t[n],r-1))}catch{}return i.length?i:"string"==s?t:t+"\x00"}function it(t,r){for(var n,i=t+"",s=0;s<i.length;)r[X&s]=X&(n^=19*r[X&s])+i.charCodeAt(s++);return de(r)}function en(){try{var t;return Pt&&(t=Pt.randomBytes)||(t=new Uint8Array(O),(ee.crypto||ee.msCrypto).getRandomValues(t)),de(t)}catch{var r=ee.navigator,n=r&&r.plugins;return[+new Date,ee,n,ee.screen,de(Me)]}}function de(t){return String.fromCharCode.apply(0,t)}function q(t){return/^\:(host|doodle)/.test(t)}function Te(t){return/^\:(container|parent)/.test(t)}function Xe(t){return q(t)||Te(t)}function tn(t){return/\:before|\:after/.test(t)}it(pe.random(),Me);let _r={};for(let e of Object.getOwnPropertyNames(Math))_r[e]=()=>(...t)=>"number"==typeof Math[e]?Math[e]:Math[e](...t=t.map(t=>L(S(t))));class rn{constructor(t){this.tokens=t,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_defined=!1,this.is_gap_defined=!1,this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.reset(),this.custom_properties={},this.uniforms={},this.content={}}reset(){for(let t in this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.canvas={},this.pattern={},this.shaders={},this.content={},this.rules)t.startsWith("#c")&&delete this.rules[t]}add_rule(t,r){let n=this.rules[t];n||(n=this.rules[t]=[]),n.push.apply(n,ye(r))}pick_func(t){return Ce[t]||_r[t]}apply_func(t,r,n){let i=t(...ye(r)),s=[];return n.forEach(t=>{let r=typeof t.value;if(t.cluster||"number"!==r&&"string"!==r){if("function"==typeof t)s.push(t);else if(!b(t.value)){let r=S(t.value);s.push(r)}}else s.push(...A(t.value,{noSpace:!0}))}),s=Yr(s),"function"==typeof i?i(...ye(s)):i}compose_aname(...t){return t.join("-")}compose_selector({x:t,y:r,z:n},i=""){return`#${ue(t,r,n)}${i}`}is_composable(t){return["doodle","shaders","canvas","pattern"].includes(t)}read_var(t,r){let n=r.count,i=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[n]);if(void 0!==i[t]){let r=String(i[t]).trim();return"("==r[0]&&")"===r[r.length-1]&&(r=r.substring(1,r.length-1)),r.replace(/;+$/g,"")}return t}compose_argument(t,r,n=[],i){r.extra||(r.extra=[]),r.extra.push(n);let s=t.map(t=>{if("text"===t.type)return/^\-\-\w/.test(t.value)?i&&"@var"===i.name?t.value:this.read_var(t.value,r):t.value;if("func"===t.type){let i=t.name.substr(1),s=this.pick_func(i);if("function"!=typeof s)return t.name;{if(this.check_uniforms(i),this.is_composable(i)){let n=S((t.arguments[0]||[])[0]),s;if("doodle"===i&&/^\d/.test(n)&&(s=n,n=S((val.arguments[1]||[])[0])),!b(n))switch(i){case"doodle":return this.compose_doodle(this.inject_variables(n,r.count),s);case"shaders":return this.compose_shaders(n,r);case"canvas":return this.compose_canvas(n,t.arguments.slice(1));case"pattern":return this.compose_pattern(n,r)}}r.position=t.position;let o=t.arguments.map(i=>s.lazy?(...n)=>this.compose_argument(i,r,n,t):this.compose_argument(i,r,n,t));return this.apply_func(s,r,o)}}});return r.extra.pop(),{cluster:t.cluster,value:s.length>=2?{value:s.join("")}:s[0]}}compose_doodle(t,r){let n=re("doodle");return this.doodles[n]={doodle:t,arg:r},"${"+n+"}"}compose_shaders(t,{x:r,y:n,z:i}){let s=re("shader");return this.shaders[s]={id:"--"+s,shader:t,cell:ue(r,n,i)},"${"+s+"}"}compose_pattern(t,{x:r,y:n,z:i}){let s=re("pattern");return this.pattern[s]={id:"--"+s,code:t,cell:ue(r,n,i)},"${"+s+"}"}compose_canvas(t,r=[]){let n=t,i=r.map(t=>S(t[0])).join(",");i.length&&(n=t+","+i);let s=re("canvas");return this.canvas[s]={code:n},"${"+s+"}"}check_uniforms(t){switch(t){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}inject_variables(t,r){let n=Object.assign({},this.custom_properties.host,this.custom_properties.container,this.custom_properties[r]),i=[];for(let[t,r]of Object.entries(n))i.push(`${t}: ${r};`);return(i=i.join("")).length?`:doodle { ${i} }`+t:t}compose_value(t,r){if(!Array.isArray(t))return{value:"",extra:""};let n="";return{value:t.reduce((t,i)=>{switch(i.type){case"text":t+=i.value;break;case"func":{let s=i.name.substr(1),o=this.pick_func(s);if("function"==typeof o){if(this.check_uniforms(s),this.is_composable(s)){let n=S((i.arguments[0]||[])[0]),o;if("doodle"===s&&/^\d/.test(n)&&(o=n,n=S((i.arguments[1]||[])[0])),!b(n))switch(s){case"doodle":t+=this.compose_doodle(this.inject_variables(n,r.count),o);break;case"shaders":t+=this.compose_shaders(n,r);break;case"pattern":t+=this.compose_pattern(n,r);break;case"canvas":t+=this.compose_canvas(n,i.arguments.slice(1))}}else{r.position=i.position;let s=i.arguments.map(t=>o.lazy?(...n)=>this.compose_argument(t,r,n,i):this.compose_argument(t,r,[],i)),l=this.apply_func(o,r,s);b(l)||(t+=l,l.extra&&(n=l.extra))}}else t+=i.name}}return t},""),extra:n}}add_grid_style({fill:t,clip:r,rotate:n,scale:i,translate:s,flexRow:o,flexColumn:l}){t&&this.add_rule(":host",`background-color: ${t};`),r||this.add_rule(":host","contain: none;"),n&&this.add_rule(":container",`rotate: ${n};`),i&&this.add_rule(":container",`scale: ${i};`),s&&this.add_rule(":container",`translate: ${s};`),o&&(this.add_rule(":container","display: flex;"),this.add_rule("cell","flex: 1;")),l&&(this.add_rule(":container","display: flex; flex-direction: column;"),this.add_rule("cell","flex: 1;"))}compose_rule(t,r,n){let i=Object.assign({},r),s=t.property,o;if("@seed"===s)return"";let l=t.value.reduce((t,r)=>{let n=this.compose_value(r,i);return n&&(n.value&&t.push(n.value),n.extra&&(o=n.extra)),t},[]),a=l.join(", ");if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,q(n)){let t=T[s];t&&a&&(a=t+","+a)}if(i.count>1){let{count:t}=i;switch(s){case"animation-name":a=l.map(r=>this.compose_aname(r,t)).join(", ");break;case"animation":a=l.map(r=>{let n=(r||"").split(/\s+/);return n[0]=this.compose_aname(n[0],t),n.join(" ")}).join(", ")}}}"content"===s&&(/["']|^none\s?$|^(var|counter|counters|attr|url)\(/.test(a)||(a=`'${a}'`)),"transition"===s&&(this.props.has_transition=!0);let u=`${s}: ${a};`;if(u=pr(s,u),"clip-path"===s&&(u+=";overflow: hidden;"),("width"===s||"height"===s)&&(Xe(n)||(u+=`--internal-cell-${s}: ${a};`)),/^(background|background\-image)$/.test(s)&&/\$\{(canvas|shader|pattern)/.test(a)&&(u+="background-size: 100% 100%;"),/^\-\-/.test(s)){let t=r.count;Te(n)&&(t="container"),q(n)&&(t="host"),this.custom_properties[t]||(this.custom_properties[t]={}),this.custom_properties[t][s]=a}if(/^@/.test(s)&&Se[s.substr(1)]){let r=s.substr(1),l=Se[r](a,{is_special_selector:Xe(n),grid:i.grid,max_grid:i.max_grid,extra:o});switch(r){case"grid":q(n)?(u=l.size||"",this.add_grid_style(l)):(u="",this.is_grid_defined||(l=Se[r](a,{is_special_selector:!0,grid:i.grid,max_grid:i.max_grid}),this.add_rule(":host",l.size||""),this.add_grid_style(l))),this.grid=i.grid,this.is_grid_defined=!0;break;case"gap":u="",this.is_gap_defined||(this.add_rule(":container",`gap: ${l};`),this.is_gap_defined=!0);break;case"content":{u="";let t=this.compose_selector(i);void 0===l||tn(n)||Te(n)||(this.content[t]=nn(String(l))),this.content[t]=Ce.raw({rules:{doodles:this.doodles}})(this.content[t]||"")}case"seed":u="";break;case"place-cell":case"place":case"position":case"offset":q(n)||(u=l);break;case"use":t.value.length&&this.compose(i,t.value),u="";break;default:u=l}}return u}get_raw_value(t){let r=t.raw();b(r)&&(r="");let[n,...i]=r.split(t.property);return i.join(t.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,"")}pre_compose_rule(t,r){let n=Object.assign({},r),i=t.property;switch(i){case"@grid":{let s=t.value.reduce((t,r)=>{let i=this.compose_value(r,n);return i&&i.value&&t.push(i.value),t},[]).join(", "),o=Se[i.substr(1)](s,{max_grid:r.max_grid});this.grid=o.grid;break}case"@use":t.value.length&&this.pre_compose(n,t.value)}}pre_compose(t,r){b(this.seed)&&((r||this.tokens).forEach(t=>{if("rule"===t.type&&"@seed"===t.property&&(this.seed=this.get_raw_value(t)),"pseudo"===t.type&&q(t.selector))for(let r of ye(t.styles))"rule"===r.type&&"@seed"===r.property&&(this.seed=this.get_raw_value(r))}),b(this.seed)||t.update_random(this.seed)),(r||this.tokens).forEach(r=>{switch(r.type){case"rule":this.pre_compose_rule(r,t);break;case"pseudo":q(r.selector)&&(r.styles||[]).forEach(r=>{this.pre_compose_rule(r,t)})}})}compose(t,r,n){this.coords.push(t),(r||this.tokens).forEach((r,i)=>{if(r.skip||n&&this.grid)return!1;switch(r.type){case"rule":this.add_rule(this.compose_selector(t),this.compose_rule(r,t));break;case"pseudo":{r.selector.startsWith(":doodle")&&(r.selector=r.selector.replace(/^\:+doodle/,":host"));let n=Xe(r.selector);n&&(r.skip=!0),r.selector.split(",").forEach(i=>{let s=r.styles.map(r=>this.compose_rule(r,t,i)),o=n?i:this.compose_selector(t,i);this.add_rule(o,s)});break}case"cond":{let n=Yi[r.name.substr(1)];if(n){let i=r.arguments.map(r=>this.compose_argument(r,t)),s=this.apply_func(n,t,i);if(Array.isArray(r.addition))for(let t of r.addition)"not"===t&&(s=!s);s&&this.compose(t,r.styles)}break}case"keyframes":this.keyframes[r.name]||(this.keyframes[r.name]=t=>`
              ${_e(r.steps.map(r=>`
                ${r.name} {
                  ${_e(r.styles.map(r=>this.compose_rule(r,t)))}
                }
              `))}
            `)}})}output(){for(let[t,r]of Object.entries(this.rules))if(Te(t))this.styles.container+=`
          .container {
            ${_e(r)}
          }
        `;else{let n=q(t)?"host":"cells",i=_e(r).trim(),s="host"===n?`${t}, .host`:t;this.styles[n]+=`${s} { ${i} }`}return this.uniforms.time&&(this.styles.container+=`
        :host, .host {
          animation: ${T.animation};
        }
      `,this.styles.keyframes+=`
       @keyframes ${T["animation-name"]} {
         from { --${T.name}: 0 }
         to { --${T.name}: ${T["animation-duration"]/10} }
       }
      `),this.coords.forEach((t,r)=>{for(let[n,i]of Object.entries(this.keyframes)){let s=this.compose_aname(n,t.count);this.styles.keyframes+=`
          ${Pr(0===r,`@keyframes ${n} { ${i(t)} }`)}
          @keyframes ${s} {
            ${i(t)}
          }
        `}}),{props:this.props,styles:this.styles,grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,canvas:this.canvas,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}}function nn(t){return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.substring(1,t.length-1):t}function Ct(t,r,n,i,s){let o=new rn(t),l=s||ke(String(n)),a={};function u(t=0,r){return 1==arguments.length&&([t,r]=[0,t]),I(l(),t,r)}function c(...t){let r=t.reduce((t,r)=>t.concat(r),[]);return r[~~(l()*r.length)]}function h(t){let r=[...t],n=t.length;for(;n;){let t=~~(l()*n--),i=r[n];r[n]=r[t],r[t]=i}return r}o.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:l,rand:u,pick:c,shuffle:h,max_grid:i,update_random:function(t){l=ke(String(t))},seed_value:n,rules:o});let{grid:p,seed:f}=o.output();if(p&&(r=p),f?l=ke(f=String(f)):f=n,b(f)&&(l=ke(f=Date.now())),f=String(f),o.seed=f,o.random=l,o.reset(),1==r.z)for(let t=1,n=0;t<=r.y;++t)for(let s=1;s<=r.x;++s)o.compose({x:s,y:t,z:1,count:++n,grid:r,context:a,rand:u,pick:c,shuffle:h,random:l,seed:f,max_grid:i,rules:o});else for(let t=1,n=0;t<=r.z;++t)o.compose({x:1,y:1,z:t,count:++n,grid:r,context:a,rand:u,pick:c,shuffle:h,random:l,seed:f,max_grid:i,rules:o});return o.output()}function Mt(t,r,n){let i=t.createShader(r);return t.shaderSource(i,n),t.compileShader(i),i}function sn(t,r,n){let i=Mt(t,t.VERTEX_SHADER,r),s=Mt(t,t.FRAGMENT_SHADER,n),o=t.createProgram();return t.attachShader(o,i),t.attachShader(o,s),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(console.warn("Link failed: "+t.getProgramInfoLog(o)),console.warn("vs info-log: "+t.getShaderInfoLog(i)),console.warn("fs info-log: "+t.getShaderInfoLog(s))),o}function H(t,r){return t.includes(r)?t:r+`
`+t}let ln=`#version 300 es
  precision highp float;
  out vec4 FragColor;
`,an=`#version 300 es
  in vec4 position;
  void main() {
    gl_Position = position;
  }
`;function un(t,r,n){let i=t.createTexture();t.activeTexture(t["TEXTURE"+n]),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)}function Lt(t,r,n,i){let s=D.get(t);if(s)return Promise.resolve(s);let o=document.createElement("canvas"),l=window.devicePixelRatio||1;r*=l,n*=l,o.width=r,o.height=n;let a=o.getContext("webgl2",{preserveDrawingBuffer:!0});if(!a)return Promise.resolve("");let u=H(t.fragment||"","uniform vec2 u_resolution;");u=H(u,"uniform float u_time;"),u=H(u,"uniform float u_timeDelta;"),u=H(u,"uniform int u_frameIndex;"),u=H(u,"uniform vec2 u_seed;"),t.textures.forEach(t=>{let r=`uniform sampler2D ${t.name};`;u=H(u,r)}),/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/mg.test(u)&&(u=`// https://www.shadertoy.com/howto

#define iResolution vec3(u_resolution, 0)
#define iTime u_time
#define iTimeDelta u_timeDelta
#define iFrame u_frameIndex

${t.textures.map((t,r)=>`#define iChannel${r} ${t.name}`).join(`
`)}

${u}

void main() {
  mainImage(FragColor, gl_FragCoord.xy);
}`);let c=sn(a,t.vertex||an,ln+u),h=a.getAttribLocation(c,"position"),p=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,p),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),a.STATIC_DRAW),a.enableVertexAttribArray(h),a.vertexAttribPointer(h,2,a.FLOAT,!1,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(c);let f=a.getUniformLocation(c,"u_resolution");a.uniform2fv(f,[r,n]),t.textures.forEach((t,r)=>{un(a,t.value,r),a.uniform1i(a.getUniformLocation(c,t.name),r)});let m=a.getUniformLocation(c,"u_seed");m&&a.uniform2f(m,Ge(i)/1e16,Math.random());let d=a.getUniformLocation(c,"u_time"),g=a.getUniformLocation(c,"u_frameIndex"),y=a.getUniformLocation(c,"u_timeDelta");if(!d&&!y&&!g)return a.drawArrays(a.TRIANGLES,0,6),Promise.resolve(D.set(t,o.toDataURL()));{let r=0,n=0;return Promise.resolve(D.set(t,t=>(a.clear(a.COLOR_BUFFER_BIT),d&&a.uniform1f(d,t/1e3),g&&a.uniform1i(g,r++),y&&(a.uniform1f(y,(n-t)/1e3),n=t),a.drawArrays(a.TRIANGLES,0,6),o.toDataURL())))}}function on(t,r){let n=[];for(;t.next();){let{curr:r,next:i}=t.get(),s=!i||r.isSymbol(";")||i.isSymbol("}");if(n.push(r),s)break}return n.length&&(r.value=nt(n)),r}function vr(t,r){let n=[],i=[],s=r&&r.type||"",o=[];for(;t.next();){let{prev:l,curr:a,next:u}=t.get(),c=!u||a.isSymbol("}");if("block"===s&&c){u||!n.length||a.isSymbol("}")||(n[n.length-1].value+=";"+a.value),r.value=n;break}if(a.isSymbol("{")&&i.length&&!o.length){let r=fn(i);if(!r.length)continue;let s=vr(t,{type:"block",name:"unkown",value:[]});r.forEach(t=>{let r=Object.assign({},s,{name:t.name,args:t.args});n.push(r)}),i=[]}else if(a.isSymbol(":")&&i.length&&!o.length){let o=nt(i);n.push(on(t,{type:"statement",name:o,value:""})),"block"==s&&(r.value=n),i=[]}else a.isSymbol(";")?n.length&&i.length&&(n[n.length-1].value+=";"+nt(i),i=[]):(a.isSymbol("(")&&o.push(a),a.isSymbol(")")&&o.pop(),i.push(a))}return n.length&&"block"==s&&(r.value=n),s?r:n}function nt(t){return t.filter((r,n)=>!(r.isSymbol(";")&&n===t.length-1)).map(t=>t.value).join("")}function fn(t){let r=C(t),n=[],i="",s=[],o=[],l=[];for(;r.next();){let{curr:t,next:a}=r.get();!i.length&&t.isWord()?i=t.value:t.isSymbol("(")?(l.length&&o.push(t.value),l.push(t)):t.isSymbol(")")?(l.pop(),l.length?o.push(t.value):o.length&&(s.push(o.join("")),o=[])):t.isSymbol(",")?l.length?(s.push(o.join("")),o=[]):(o.length&&(s.push(o.join("")),o=[]),i&&(n.push({name:i,args:s}),i="",s=[],o=[])):o.push(t.value)}return i&&n.push({name:i,args:s}),n.filter((t,r,n)=>n.findIndex(r=>r.name===t.name&&t.args.join("")==r.args.join(""))===r)}function cn(t){return vr(C(z(t)))}function hn(t,r){return`
    vec3 mapping(vec2 uv, vec2 grid) {
      vec2 _grid = 1.0/grid;
      float x = ceil(uv.x/_grid.x);
      float y = ceil(grid.y - uv.y/_grid.y);
      float i = x + (y - 1.0) * y;
      return vec3(x, y, i);
    }
    vec4 getColor(float x, float y, float i, float I, float X, float Y, float t) {
      vec4 color = vec4(0, 0, 0, 0);
      ${t}
      return color;
    }
    void main() {
      vec2 uv = gl_FragCoord.xy/u_resolution.xy;
      vec2 grid = vec2(${r.x}, ${r.y});
      vec3 p = mapping(uv, grid);
      FragColor = getColor(p.x, p.y, p.z, grid.x * grid.y, grid.x, grid.y, u_time);
    }
  `}function br(t,r){if("fill"===t.name){let{r:n,g:i,b:s,a:o}=r.get_rgba_color(t.value);return{type:"statement",value:`
color = vec4(${je(n/255)}, ${je(i/255)}, ${je(s/255)}, ${je(o)});
`}}return"grid"==t.name?{type:"grid",value:t.value}:{type:"statement",value:""}}function mn(t,r){if("match"===t.name){let n=t.args[0],i=[];return t.value.forEach(t=>{let n=br(t,r);"statement"==n.type&&i.push(n.value)}),`
      if (${n}) {
        ${i.join("")}
      }
    `}return""}function je(t){return String(t).includes(".")?t:t+".0"}function pn(t,r){let n=cn(t),i=[],s={x:1,y:1};return n.forEach(t=>{if("statement"===t.type){let n=br(t,r);"statement"==n.type&&i.push(n.value),"grid"===n.type&&(s=Ht(n.value))}else"block"===t.type&&i.push(mn(t,r))}),hn(i.join(""),s)}let dn=Xt();function gn(t){let r=D.get(t);if(r)return Promise.resolve(r);let n=dn("css-doodle-paint"),i=yn(n,t),s=new Blob([i],{type:"text/javascript"});try{CSS.paintWorklet&&CSS.paintWorklet.addModule(URL.createObjectURL(s))}catch{}return Promise.resolve(D.set(t,`paint(${n})`))}function yn(t,r){return(r=Ye(r)).includes("paint(")||(r=`
      paint(ctx, {width, height}, props) {
        ${r}
      }
    `),`
    registerPaint('${t}', class {
      ${r}
    })
  `}function _n(t,r,n,i){return new Promise((s,o)=>{let l=`data:image/svg+xml;utf8,${encodeURIComponent(t)}`;function a(){let t=new Image;t.crossOrigin="anonymous",t.src=l,t.onload=()=>{let a=document.createElement("canvas"),u=a.getContext("2d"),c=window.devicePixelRatio||1;1!=i&&(c=1),a.width=r*c,a.height=n*c,u.drawImage(t,0,0,a.width,a.height);try{a.toBlob(t=>{s({blob:t,source:l,url:URL.createObjectURL(t)})})}catch(t){o(t)}}}Ve()?Ft(l,a,200):a()})}function vn(t){if(typeof getComputedStyle>"u")return"";let r={};if(t.computedStyleMap)for(let[n,i]of t.computedStyleMap())n.startsWith("--")&&(r[n]=i[0][0]);else{let n=getComputedStyle(t);for(let t of n)t.startsWith("--")&&(r[t]=n.getPropertyValue(t))}return xn(r)}function bn(t,r){return typeof getComputedStyle>"u"?"":getComputedStyle(t).getPropertyValue(r).trim().replace(/^\(|\)$/g,"")}function xn(t){let r=[];for(let[n,i]of Object.entries(t))r.push(n+":"+i);return r.join(";")}function wn(t){let[r,n,i,s=1]=t.replace(/rgba?\((.+)\)/,(t,r)=>r).split(/,\s*/);return{r,g:n,b:i,a:s}}function $n(t,r){let n=t.querySelector("#defs");return n?(n.style.color=r,wn(getComputedStyle(n).color)):{r:0,g:0,b:0,a:1}}let It=1e3/60,Ot=1e3;function Sn(t){let r,n=0,i=0,s=0,o=!1;function l(o){n||(n=o),t(n);let a=o-i;a<It&&(a=It),a>1e3&&(a=s||1e3),i&&(n+=a),s=a,i=o,r=requestAnimationFrame(l)}return r=requestAnimationFrame(l),{resume(){r&&o&&(o=!1,r=requestAnimationFrame(l))},pause(){r&&(cancelAnimationFrame(r),o=!0)},cancel(){r&&(o=!1,cancelAnimationFrame(r),r=null)}}}if("u">typeof customElements){class t extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:t=>bn(this,t),get_rgba_color:t=>$n(this.shadowRoot,t)}}connectedCallback(t){this.innerHTML?this.load(t):setTimeout(()=>this.load(t))}disconnectedCallback(){this.cleanup()}cleanup(){for(let t of(D.clear(),this.animations))t.cancel();this.animations=[]}update(t){this.cleanup(),t||(t=Ye(this._innerHTML)),this._innerHTML!==t&&(this._innerHTML=t),this.grid_size||(this.grid_size=this.get_grid());let{x:r,y:n,z:i}=this.grid_size,s=this.get_use(),o="";this.compiled&&(o=this.compiled.content);let l=this.generate(ne(s+t,this.extra)),a=l.grid||this.get_grid(),{x:u,y:c,z:h}=a,p=!this.shadowRoot.innerHTML||this.shadowRoot.querySelector("css-doodle")||r!==u||n!==c||i!==h||JSON.stringify(o)!==JSON.stringify(l.content);if(Object.assign(this.grid_size,a),p)return l.grid?this.build_grid(l,a):this.build_grid(this.generate(ne(s+t,this.extra)),a);let f=this.replace(l);this.set_content(".style-keyframes",f(l.styles.keyframes)),l.props.has_animation&&(this.set_content(".style-cells",""),this.set_content(".style-container","")),setTimeout(()=>{this.set_content(".style-container",f(He(this.grid_size)+l.styles.host+l.styles.container)),this.set_content(".style-cells",f(l.styles.cells))})}get grid(){return Object.assign({},this.grid_size)}set grid(t){this.attr("grid",t),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(t){this.attr("seed",t),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(t){this.attr("use",t),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return Qe(this.attr("grid"),this.get_max_grid())}get_use(){let t=String(this.attr("use")||"").trim();return/^var\(/.test(t)&&(t=`@use:${t};`),t}attr(t,r){return 1==arguments.length?this.getAttribute(t):2==arguments.length?(this.setAttribute(t,r),r):void 0}generate(t){let r=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");b(n)&&(n=Date.now());let i=this.compiled=Ct(t,r,n,this.get_max_grid());return this._seed_value=i.seed,this._seed_random=i.random,i}doodle_to_image(t,r,n){"function"==typeof r&&(n=r,r=null);let i=ne(t=":doodle { width:100%;height:100% }"+t,this.extra),s=Qe(""),o=Ct(i,s,this._seed_value,this.get_max_grid(),this._seed_random),l=o.grid?o.grid:s,{keyframes:a,host:u,container:c,cells:h}=o.styles,p="";if(r&&r.arg){let t=Ht(r.arg);t.x&&t.y&&(r.width=t.x+"px",r.height=t.y+"px",p=`viewBox="0 0 ${t.x} ${t.y}"`)}let f=this.replace(o),m=Ut(l,o.content),d=r&&r.width&&r.height?`width="${r.width}" height="${r.height}"`:"";f(`
        <svg ${d} xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" ${p}>
          <foreignObject width="100%" height="100%">
            <div class="host" width="100%" height="100%" xmlns="http://www.w3.org/1999/xhtml">
              <style>
                ${zt()}
                ${He(l)}
                ${u}
                ${c}
                ${h}
                ${a}
              </style>
              <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0; height:0"></svg>
              ${m}
            </div>
          </foreignObject>
        </svg>
      `).then(t=>{let r=`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(t)))}`;Ve()&&Ft(r),n(r)})}pattern_to_image({code:t,cell:r,id:n},i){let s=pn(t,this.extra);this.shader_to_image({shader:s,cell:r,id:n},i)}canvas_to_image({code:t},r){gn(t).then(r)}pause(){for(let t of(this.setAttribute("cssd-paused-animation",!0),this.animations))t.pause()}resume(){for(let t of(this.removeAttribute("cssd-paused-animation"),this.animations))t.resume()}shader_to_image({shader:t,cell:r,id:n},i){let s="string"==typeof t?oi(t):t,o=this.doodle.getElementById(r),l=this.seed,a=t=>{o.style.setProperty(n,`url(${t})`)},u=t=>{if("function"==typeof t){let r=Sn(r=>{a(t(r))});return this.animations.push(r),""}a(t)},{width:c,height:h}=o&&o.getBoundingClientRect()||{width:0,height:0},p=window.devicePixelRatio||1;!s.textures.length||s.ticker?Lt(s,c,h,l).then(u).then(i):Promise.all(s.textures.map(t=>new Promise(r=>{this.doodle_to_image(t.value,{width:c,height:h},n=>{let i=new Image;i.width=c*p,i.height=h*p,i.onload=()=>r({name:t.name,value:i}),i.src=n})}))).then(t=>{s.textures=t,Lt(s,c,h,l).then(u).then(i)})}load(t){this.cleanup();let r=ne(this.get_use()+Ye(this.innerHTML),this.extra),n=this.generate(r);t||this.hasAttribute("click-to-update")&&this.addEventListener("click",t=>this.update()),this.grid_size=n.grid?n.grid:this.get_grid(),this.build_grid(n,this.grid_size),this._innerHTML=this.innerHTML,this.innerHTML=""}replace({doodles:t,shaders:r,canvas:n,pattern:i}){let s=Object.keys(t),o=Object.keys(r),l=Object.keys(n),a=Object.keys(i),u=s.length+l.length+o.length+a.length;return c=>u?Promise.all([].concat(s.map(r=>c.includes(r)?new Promise(n=>{let{arg:i,doodle:s}=t[r];this.doodle_to_image(s,{arg:i},t=>n({id:r,value:t}))}):Promise.resolve("")),o.map(t=>c.includes(t)?new Promise(n=>{this.shader_to_image(r[t],r=>n({id:t,value:r}))}):Promise.resolve("")),l.map(t=>c.includes(t)?new Promise(r=>{this.canvas_to_image(n[t],n=>r({id:t,value:n}))}):Promise.resolve("")),a.map(t=>c.includes(t)?new Promise(r=>{this.pattern_to_image(i[t],n=>r({id:t,value:n}))}):Promise.resolve("")))).then(t=>{for(let{id:r,value:n}of t){let t=`url(${n})`;/^canvas/.test(r)&&(t=n),/^shader|^pattern/.test(r)&&(t=`var(--${r})`),c=c.replaceAll("${"+r+"}",t)}return c}):Promise.resolve(c)}build_grid(t,r){let{has_transition:n,has_animation:i}=t.props,s=n||i,{keyframes:o,host:l,container:a,cells:u}=t.styles,c=He(r)+l+a,h=s?"":u,{uniforms:p,content:f}=t,m=this.replace(t);this.doodle.innerHTML=`
        <style>${zt()}</style>
        <style class="style-keyframes">${o}</style>
        <style class="style-container">${c}</style>
        <style class="style-cells">${h}</style>
        <svg id="defs" xmlns="http://www.w3.org/2000/svg" style="width:0;height:0"></svg>
        ${Ut(r,f)}
      `,this.set_content(".style-container",m(c)),s?setTimeout(()=>{this.set_content(".style-cells",m(u))},50):this.set_content(".style-cells",m(u)),p.time&&this.register_uniform_time(),p.mousex||p.mousey?this.register_uniform_mouse(p):this.remove_uniform_mouse(),p.width||p.height?this.register_uniform_resolution(p):this.remove_uniform_resolution()}register_uniform_mouse(t){if(!this.uniform_mouse_callback){let{uniform_mousex:r,uniform_mousey:n}=V;this.uniform_mouse_callback=i=>{let s=i.detail||i;t.mousex&&this.style.setProperty("--"+r.name,s.offsetX),t.mousey&&this.style.setProperty("--"+n.name,s.offsetY)},this.addEventListener("pointermove",this.uniform_mouse_callback);let i=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(i)}}remove_uniform_mouse(){if(this.uniform_mouse_callback){let{uniform_mousex:t,uniform_mousey:r}=V;this.style.removeProperty("--"+t.name),this.style.removeProperty("--"+r.name),this.removeEventListener("pointermove",this.uniform_mouse_callback),this.uniform_mouse_callback=null}}register_uniform_resolution(t){if(!this.uniform_resolution_observer){let{uniform_width:r,uniform_height:n}=V,i=()=>{let i=this.getBoundingClientRect();t.width&&this.style.setProperty("--"+r.name,i.width),t.height&&this.style.setProperty("--"+n.name,i.height)};i(),this.uniform_resolution_observer=new ResizeObserver(t=>{for(let r of t)(r.contentBoxSize||r.contentRect)&&i()}),this.uniform_resolution_observer.observe(this)}}remove_uniform_resolution(){if(this.uniform_resolution_observer){let{uniform_width:t,uniform_height:r}=V;this.style.removeProperty("--"+t.name),this.style.removeProperty("--"+r.name),this.uniform_resolution_observer.unobserve(this),this.uniform_resolution_observer=null}}register_uniform_time(){if(!window.CSS||!window.CSS.registerProperty)return!1;if(!this.is_uniform_time_registered){let{uniform_time:t}=V;try{CSS.registerProperty({name:"--"+t.name,syntax:"<number>",initialValue:0,inherits:!0})}catch{}this.is_uniform_time_registered=!0}}export({scale:t,name:r,download:n,detail:i}={}){return new Promise((s,o)=>{let l=vn(this),a=this.doodle.innerHTML,{width:u,height:c}=this.getBoundingClientRect(),h=u*(t=parseInt(t)||1),p=c*t,f=`
          <svg xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="none"
            viewBox="0 0 ${u} ${c}"
            ${Ve()?"":`width="${h}px" height="${p}px"`}
          >
            <foreignObject width="100%" height="100%">
              <div
                class="host"
                xmlns="http://www.w3.org/1999/xhtml"
                style="width: ${u}px; height: ${c}px; "
              >
                <style>.host { ${Lr(l)} }</style>
                ${a}
              </div>
            </foreignObject>
          </svg>
        `;n||i?_n(f,h,p,t).then(({source:t,url:i,blob:o})=>{if(s({width:h,height:p,svg:f,blob:o,source:t}),n){let t=document.createElement("a");t.download=Mr(r),t.href=i,t.click()}}).catch(t=>{o(t)}):s({width:h,height:p,svg:f})})}set_content(t,r){if(r instanceof Promise)r.then(r=>{this.set_content(t,r)});else{let n=this.shadowRoot.querySelector(t);n&&(n.styleSheet?n.styleSheet.cssText=r:n.innerHTML=r)}}}customElements.get("css-doodle")||customElements.define("css-doodle",t)}function zt(){let{uniform_time:t}=V,r=hr(/grid/).map(t=>`${t}: inherit;`).join("");return`
    *, *::after, *::before {
      box-sizing: border-box;
    }
    :host, .host {
      display: block;
      visibility: visible;
      width: auto;
      height: auto;
      contain: content;
      box-sizing: border-box;
      --${t.name}: 0
    }
    :host([hidden]), .host[hidden] {
      display: none
    }
    .container {
      position: relative;
      width: 100%;
      height: 100%;
      display: grid;
      ${r}
    }
    cell {
      position: relative;
      display: grid;
      place-items: center
    }
    svg {
      position: absolute;
      width: 100%;
      height: 100%
    }
    :host([cssd-paused-animation]),
    :host([cssd-paused-animation]) * {
      animation-play-state: paused !important
    }
  `}function He(t){let{x:r,y:n}=t||{};return`
    :host, .host {
      grid-template-rows: repeat(${n}, 1fr);
      grid-template-columns: repeat(${r}, 1fr);
    }
  `}function Bt(t){return b(t)?"":t}function Wt(t,r,n,i,s=""){let o=ue(t,r,n),l=Bt(i["#"+o]),a=Bt(s);return`<cell id="${o}">${l}${a}</cell>`}function Ut(t,r){let{x:n,y:i,z:s}=t||{},o="";if(1==s)for(let t=1;t<=i;++t)for(let i=1;i<=n;++i)o+=Wt(i,t,1,r);else{let t="";for(let n=s;n>=1;n--)t=Wt(1,1,n,r,t);o=t}return`<grid class="container">${o}</grid>`}